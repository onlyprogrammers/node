var rrwebReplay=function(fe){"use strict";var R;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(R||(R={}));function $t(e){return e.nodeType===e.ELEMENT_NODE}var Be=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(i){return n.removeNodeFromMap(i)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Vt(){return new Be}function Wt(e,t){return!e||!t||e.type!==t.type?!1:e.type===R.Document?e.compatMode===t.compatMode:e.type===R.DocumentType?e.name===t.name&&e.publicId===t.publicId&&e.systemId===t.systemId:e.type===R.Comment||e.type===R.Text||e.type===R.CDATA?e.textContent===t.textContent:e.type===R.Element?e.tagName===t.tagName&&JSON.stringify(e.attributes)===JSON.stringify(t.attributes)&&e.isSVG===t.isSVG&&e.needBlock===t.needBlock:!1}var $e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function jt(e,t){t===void 0&&(t={});var n=1,r=1;function i(y){var m=y.match(/\n/g);m&&(n+=m.length);var D=y.lastIndexOf(`
`);r=D===-1?r+y.length:y.length-D}function l(){var y={line:n,column:r};return function(m){return m.position=new o(y),E(),m}}var o=function(){function y(m){this.start=m,this.end={line:n,column:r},this.source=t.source}return y}();o.prototype.content=e;var a=[];function s(y){var m=new Error("".concat(t.source||"",":").concat(n,":").concat(r,": ").concat(y));if(m.reason=y,m.filename=t.source,m.line=n,m.column=r,m.source=e,t.silent)a.push(m);else throw m}function c(){var y=d();return{type:"stylesheet",stylesheet:{source:t.source,rules:y,parsingErrors:a}}}function u(){return f(/^{\s*/)}function p(){return f(/^}/)}function d(){var y,m=[];for(E(),g(m);e.length&&e.charAt(0)!=="}"&&(y=_()||ee());)y!==!1&&(m.push(y),g(m));return m}function f(y){var m=y.exec(e);if(m){var D=m[0];return i(D),e=e.slice(D.length),m}}function E(){f(/^\s*/)}function g(y){y===void 0&&(y=[]);for(var m;m=v();)m!==!1&&y.push(m),m=v();return y}function v(){var y=l();if(!(e.charAt(0)!=="/"||e.charAt(1)!=="*")){for(var m=2;e.charAt(m)!==""&&(e.charAt(m)!=="*"||e.charAt(m+1)!=="/");)++m;if(m+=2,e.charAt(m-1)==="")return s("End of comment missing");var D=e.slice(2,m-2);return r+=2,i(D),e=e.slice(m),r+=2,y({type:"comment",comment:D})}}function h(){var y=f(/^([^{]+)/);if(y)return H(y[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(m){return m.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(m){return m.replace(/\u200C/g,",")})}function N(){var y=l(),m=f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(m){var D=H(m[0]);if(!f(/^:\s*/))return s("property missing ':'");var x=f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),P=y({type:"declaration",property:D.replace($e,""),value:x?H(x[0]).replace($e,""):""});return f(/^[;\s]*/),P}}function w(){var y=[];if(!u())return s("missing '{'");g(y);for(var m;m=N();)m!==!1&&(y.push(m),g(y)),m=N();return p()?y:s("missing '}'")}function T(){for(var y,m=[],D=l();y=f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)m.push(y[1]),f(/^,\s*/);if(m.length)return D({type:"keyframe",values:m,declarations:w()})}function C(){var y=l(),m=f(/^@([-\w]+)?keyframes\s*/);if(m){var D=m[1];if(m=f(/^([-\w]+)\s*/),!m)return s("@keyframes missing name");var x=m[1];if(!u())return s("@keyframes missing '{'");for(var P,K=g();P=T();)K.push(P),K=K.concat(g());return p()?y({type:"keyframes",name:x,vendor:D,keyframes:K}):s("@keyframes missing '}'")}}function I(){var y=l(),m=f(/^@supports *([^{]+)/);if(m){var D=H(m[1]);if(!u())return s("@supports missing '{'");var x=g().concat(d());return p()?y({type:"supports",supports:D,rules:x}):s("@supports missing '}'")}}function V(){var y=l(),m=f(/^@host\s*/);if(m){if(!u())return s("@host missing '{'");var D=g().concat(d());return p()?y({type:"host",rules:D}):s("@host missing '}'")}}function F(){var y=l(),m=f(/^@media *([^{]+)/);if(m){var D=H(m[1]);if(!u())return s("@media missing '{'");var x=g().concat(d());return p()?y({type:"media",media:D,rules:x}):s("@media missing '}'")}}function Z(){var y=l(),m=f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(m)return y({type:"custom-media",name:H(m[1]),media:H(m[2])})}function pe(){var y=l(),m=f(/^@page */);if(m){var D=h()||[];if(!u())return s("@page missing '{'");for(var x=g(),P;P=N();)x.push(P),x=x.concat(g());return p()?y({type:"page",selectors:D,declarations:x}):s("@page missing '}'")}}function me(){var y=l(),m=f(/^@([-\w]+)?document *([^{]+)/);if(m){var D=H(m[1]),x=H(m[2]);if(!u())return s("@document missing '{'");var P=g().concat(d());return p()?y({type:"document",document:x,vendor:D,rules:P}):s("@document missing '}'")}}function q(){var y=l(),m=f(/^@font-face\s*/);if(m){if(!u())return s("@font-face missing '{'");for(var D=g(),x;x=N();)D.push(x),D=D.concat(g());return p()?y({type:"font-face",declarations:D}):s("@font-face missing '}'")}}var j=U("import"),J=U("charset"),se=U("namespace");function U(y){var m=new RegExp("^@"+y+"\\s*([^;]+);");return function(){var D=l(),x=f(m);if(x){var P={type:y};return P[y]=x[1].trim(),D(P)}}}function _(){if(e[0]==="@")return C()||F()||Z()||I()||j()||J()||se()||me()||pe()||V()||q()}function ee(){var y=l(),m=h();return m?(g(),y({type:"rule",selectors:m,declarations:w()})):s("selector missing")}return Se(c())}function H(e){return e?e.replace(/^\s+|\s+$/g,""):""}function Se(e,t){for(var n=e&&typeof e.type=="string",r=n?e:t,i=0,l=Object.keys(e);i<l.length;i++){var o=l[i],a=e[o];Array.isArray(a)?a.forEach(function(s){Se(s,r)}):a&&typeof a=="object"&&Se(a,r)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}var Ve={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Gt(e){var t=Ve[e.tagName]?Ve[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function Yt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var We=/([^\\]):hover/,Ht=new RegExp(We.source,"g");function je(e,t){var n=t?.stylesWithHoverClass.get(e);if(n)return n;var r=jt(e,{silent:!0});if(!r.stylesheet)return e;var i=[];if(r.stylesheet.rules.forEach(function(a){"selectors"in a&&(a.selectors||[]).forEach(function(s){We.test(s)&&i.push(s)})}),i.length===0)return e;var l=new RegExp(i.filter(function(a,s){return i.indexOf(a)===s}).sort(function(a,s){return s.length-a.length}).map(function(a){return Yt(a)}).join("|"),"g"),o=e.replace(l,function(a){var s=a.replace(Ht,"$1.\\:hover");return"".concat(a,", ").concat(s)});return t?.stylesWithHoverClass.set(e,o),o}function Ge(){var e=new Map;return{stylesWithHoverClass:e}}function zt(e,t){var n=t.doc,r=t.hackCss,i=t.cache;switch(e.type){case R.Document:return n.implementation.createDocument(null,"",null);case R.DocumentType:return n.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case R.Element:{var l=Gt(e),o;e.isSVG?o=n.createElementNS("http://www.w3.org/2000/svg",l):o=n.createElement(l);var a={};for(var s in e.attributes)if(Object.prototype.hasOwnProperty.call(e.attributes,s)){var c=e.attributes[s];if(!(l==="option"&&s==="selected"&&c===!1)&&c!==null){if(c===!0&&(c=""),s.startsWith("rr_")){a[s]=c;continue}var u=l==="textarea"&&s==="value",p=l==="style"&&s==="_cssText";if(p&&r&&typeof c=="string"&&(c=je(c,i)),(u||p)&&typeof c=="string"){for(var d=n.createTextNode(c),f=0,E=Array.from(o.childNodes);f<E.length;f++){var g=E[f];g.nodeType===o.TEXT_NODE&&o.removeChild(g)}o.appendChild(d);continue}try{if(e.isSVG&&s==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",s,c.toString());else if(s==="onload"||s==="onclick"||s.substring(0,7)==="onmouse")o.setAttribute("_"+s,c.toString());else if(l==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&s==="content"){o.setAttribute("csp-content",c.toString());continue}else l==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||l==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(l==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",e.attributes.srcset):o.setAttribute(s,c.toString()))}catch{}}}var v=function(N){var w=a[N];if(l==="canvas"&&N==="rr_dataURL"){var T=document.createElement("img");T.onload=function(){var I=o.getContext("2d");I&&I.drawImage(T,0,0,T.width,T.height)},T.src=w.toString(),o.RRNodeType&&(o.rr_dataURL=w.toString())}else if(l==="img"&&N==="rr_dataURL"){var C=o;C.currentSrc.startsWith("data:")||(C.setAttribute("rrweb-original-src",e.attributes.src),C.src=w.toString())}if(N==="rr_width")o.style.width=w.toString();else if(N==="rr_height")o.style.height=w.toString();else if(N==="rr_mediaCurrentTime"&&typeof w=="number")o.currentTime=w;else if(N==="rr_mediaState")switch(w){case"played":o.play().catch(function(I){return console.warn("media playback error",I)});break;case"paused":o.pause();break}};for(var h in a)v(h);if(e.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case R.Text:return n.createTextNode(e.isStyle&&r?je(e.textContent,i):e.textContent);case R.CDATA:return n.createCDATASection(e.textContent);case R.Comment:return n.createComment(e.textContent);default:return null}}function ae(e,t){var n=t.doc,r=t.mirror,i=t.skipChild,l=i===void 0?!1:i,o=t.hackCss,a=o===void 0?!0:o,s=t.afterAppend,c=t.cache;if(r.has(e.id)){var u=r.getNode(e.id),p=r.getMeta(u);if(Wt(p,e))return r.getNode(e.id)}var d=zt(e,{doc:n,hackCss:a,cache:c});if(!d)return null;if(e.rootId&&r.getNode(e.rootId)!==n&&r.replace(e.rootId,n),e.type===R.Document&&(n.close(),n.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==R.DocumentType&&(e.childNodes[0].type===R.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),d=n),r.add(d,e),(e.type===R.Document||e.type===R.Element)&&!l)for(var f=function(h){var N=ae(h,{doc:n,mirror:r,skipChild:!1,hackCss:a,afterAppend:s,cache:c});if(!N)return console.warn("Failed to rebuild",h),"continue";if(h.isShadow&&$t(d)&&d.shadowRoot)d.shadowRoot.appendChild(N);else if(e.type===R.Document&&h.type==R.Element){var w=N,T=null;w.childNodes.forEach(function(C){C.nodeName==="BODY"&&(T=C)}),T?(w.removeChild(T),d.appendChild(N),w.appendChild(T)):d.appendChild(N)}else d.appendChild(N);s&&s(N,h.id)},E=0,g=e.childNodes;E<g.length;E++){var v=g[E];f(v)}return d}function Xt(e,t){function n(o){t(o)}for(var r=0,i=e.getIds();r<i.length;r++){var l=i[r];e.has(l)&&n(e.getNode(l))}}function Qt(e,t){var n=t.getMeta(e);if(n?.type===R.Element){var r=e;for(var i in n.attributes)if(Object.prototype.hasOwnProperty.call(n.attributes,i)&&i.startsWith("rr_")){var l=n.attributes[i];i==="rr_scrollLeft"&&(r.scrollLeft=l),i==="rr_scrollTop"&&(r.scrollTop=l)}}}function qt(e,t){var n=t.doc,r=t.onVisit,i=t.hackCss,l=i===void 0?!0:i,o=t.afterAppend,a=t.cache,s=t.mirror,c=s===void 0?new Be:s,u=ae(e,{doc:n,mirror:c,skipChild:!1,hackCss:l,afterAppend:o,cache:a});return Xt(c,function(p){r&&r(p),Qt(p,c)}),u}var S;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(S||(S={}));var Jt=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(i){return n.removeNodeFromMap(i)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Kt(){return new Jt}function Zt(e){const t={},n=/;(?![^(]*\))/g,r=/:(.+)/,i=/\/\*.*?\*\//g;return e.replace(i,"").split(n).forEach(function(l){if(l){const o=l.split(r);o.length>1&&(t[De(o[0].trim())]=o[1].trim())}}),t}function Ye(e){const t=[];for(const n in e){const r=e[n];if(typeof r!="string")continue;const i=rn(n);t.push(`${i}: ${r};`)}return t.join(" ")}const en=/-([a-z])/g,tn=/^--[a-zA-Z0-9-]+$/,De=e=>tn.test(e)?e:e.replace(en,(t,n)=>n?n.toUpperCase():""),nn=/\B([A-Z])/g,rn=e=>e.replace(nn,"-$1").toLowerCase();class B{constructor(...t){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=k.ELEMENT_NODE,this.TEXT_NODE=k.TEXT_NODE}get childNodes(){const t=[];let n=this.firstChild;for(;n;)t.push(n),n=n.nextSibling;return t}contains(t){if(t instanceof B){if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0}else return!1;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function on(e){return class Bt extends e{constructor(...n){super(n),this.nodeType=k.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=S.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(n=>n.RRNodeType===S.Element&&n.tagName==="HTML")||null}get body(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===S.Element&&r.tagName==="BODY"))||null}get head(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===S.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(n){const r=n.RRNodeType;if((r===S.Element||r===S.DocumentType)&&this.childNodes.some(l=>l.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const i=be(this,n);return i.parentElement=null,i}insertBefore(n,r){const i=n.RRNodeType;if((i===S.Element||i===S.DocumentType)&&this.childNodes.some(o=>o.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const l=Je(this,n,r);return l.parentElement=null,l}removeChild(n){return Ke(this,n)}open(){this.firstChild=null,this.lastChild=null}close(){}write(n){let r;if(n==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":n==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){const i=this.createDocumentType("html",r,"");this.open(),this.appendChild(i)}}createDocument(n,r,i){return new Bt}createDocumentType(n,r,i){const l=new(He(B))(n,r,i);return l.ownerDocument=this,l}createElement(n){const r=new(ze(B))(n);return r.ownerDocument=this,r}createElementNS(n,r){return this.createElement(r)}createTextNode(n){const r=new(Xe(B))(n);return r.ownerDocument=this,r}createComment(n){const r=new(Qe(B))(n);return r.ownerDocument=this,r}createCDATASection(n){const r=new(qe(B))(n);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}function He(e){return class extends e{constructor(t,n,r){super(),this.nodeType=k.DOCUMENT_TYPE_NODE,this.RRNodeType=S.DocumentType,this.name=t,this.publicId=n,this.systemId=r,this.nodeName=t,this.textContent=null}toString(){return"RRDocumentType"}}}function ze(e){return class extends e{constructor(t){super(),this.nodeType=k.ELEMENT_NODE,this.RRNodeType=S.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(n=>t+=n.textContent),t}set textContent(t){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(t))}get classList(){return new an(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const t=this.attributes.style?Zt(this.attributes.style):{},n=/\B([A-Z])/g;return t.setProperty=(r,i,l)=>{if(n.test(r))return;const o=De(r);i?t[o]=i:delete t[o],l==="important"&&(t[o]+=" !important"),this.attributes.style=Ye(t)},t.removeProperty=r=>{if(n.test(r))return"";const i=De(r),l=t[i]||"";return delete t[i],this.attributes.style=Ye(t),l},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,n){this.attributes[t]=n}setAttributeNS(t,n,r){this.setAttribute(n,r)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return be(this,t)}insertBefore(t,n){return Je(this,t,n)}removeChild(t){return Ke(this,t)}attachShadow(t){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(t){return!0}toString(){let t="";for(const n in this.attributes)t+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${t}`}}}function sn(e){return class extends e{attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function Xe(e){return class extends e{constructor(t){super(),this.nodeType=k.TEXT_NODE,this.nodeName="#text",this.RRNodeType=S.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function Qe(e){return class extends e{constructor(t){super(),this.nodeType=k.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=S.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function qe(e){return class extends e{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=k.CDATA_SECTION_NODE,this.RRNodeType=S.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class an{constructor(t,n){if(this.classes=[],this.add=(...r)=>{for(const i of r){const l=String(i);this.classes.indexOf(l)>=0||this.classes.push(l)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(i=>r.indexOf(i)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const r=t.trim().split(/\s+/);this.classes.push(...r)}this.onChange=n}}function be(e,t){return t.parentNode&&t.parentNode.removeChild(t),e.lastChild?(e.lastChild.nextSibling=t,t.previousSibling=e.lastChild):(e.firstChild=t,t.previousSibling=null),e.lastChild=t,t.nextSibling=null,t.parentNode=e,t.parentElement=e,t.ownerDocument=e.ownerDocument,t}function Je(e,t,n){if(!n)return be(e,t);if(n.parentNode!==e)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return t===n||(t.parentNode&&t.parentNode.removeChild(t),t.previousSibling=n.previousSibling,n.previousSibling=t,t.nextSibling=n,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,t.parentElement=e,t.parentNode=e,t.ownerDocument=e.ownerDocument),t}function Ke(e,t){if(t.parentNode!==e)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return t.previousSibling?t.previousSibling.nextSibling=t.nextSibling:e.firstChild=t.nextSibling,t.nextSibling?t.nextSibling.previousSibling=t.previousSibling:e.lastChild=t.previousSibling,t.previousSibling=null,t.nextSibling=null,t.parentElement=null,t.parentNode=null,t}var k;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(k||(k={}));const Me={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},ln={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};let G=null;function Y(e,t,n,r=t.mirror||t.ownerDocument.mirror){e=cn(e,t,n,r);const i=e.childNodes,l=t.childNodes;(i.length>0||l.length>0)&&Ze(Array.from(i),l,e,n,r),un(e,t,n,r)}function cn(e,t,n,r){var i;if(n.afterAppend&&!G&&(G=new WeakSet,setTimeout(()=>{G=null},0)),!Ce(e,t)){const l=ge(t,n.mirror,r);(i=e.parentNode)===null||i===void 0||i.replaceChild(l,e),e=l}switch(t.RRNodeType){case S.Document:{if(!te(e,t,n.mirror,r)){const l=r.getMeta(t);l&&(n.mirror.removeNodeFromMap(e),e.close(),e.open(),n.mirror.add(e,l),G?.add(e))}break}case S.Element:{const l=e,o=t;switch(o.tagName){case"IFRAME":{const a=e.contentDocument;if(!a)break;Y(a,t.contentDocument,n,r);break}}if(o.shadowRoot){l.shadowRoot||l.attachShadow({mode:"open"});const a=l.shadowRoot.childNodes,s=o.shadowRoot.childNodes;(a.length>0||s.length>0)&&Ze(Array.from(a),s,l.shadowRoot,n,r)}break}}return e}function un(e,t,n,r){var i;switch(t.RRNodeType){case S.Document:{const l=t.scrollData;l&&n.applyScroll(l,!0);break}case S.Element:{const l=e,o=t;switch(dn(l,o,r),o.scrollData&&n.applyScroll(o.scrollData,!0),o.inputData&&n.applyInput(o.inputData),o.tagName){case"AUDIO":case"VIDEO":{const a=e,s=o;s.paused!==void 0&&(s.paused?a.pause():a.play()),s.muted!==void 0&&(a.muted=s.muted),s.volume!==void 0&&(a.volume=s.volume),s.currentTime!==void 0&&(a.currentTime=s.currentTime),s.playbackRate!==void 0&&(a.playbackRate=s.playbackRate);break}case"CANVAS":{const a=t;if(a.rr_dataURL!==null){const s=document.createElement("img");s.onload=()=>{const c=l.getContext("2d");c&&c.drawImage(s,0,0,s.width,s.height)},s.src=a.rr_dataURL}a.canvasMutations.forEach(s=>n.applyCanvas(s.event,s.mutation,e));break}case"STYLE":{const a=l.sheet;a&&t.rules.forEach(s=>n.applyStyleSheetMutation(s,a));break}}break}case S.Text:case S.Comment:case S.CDATA:{e.textContent!==t.data&&(e.textContent=t.data);break}}G!=null&&G.has(e)&&(G.delete(e),(i=n.afterAppend)===null||i===void 0||i.call(n,e,n.mirror.getId(e)))}function dn(e,t,n){const r=e.attributes,i=t.attributes;for(const l in i){const o=i[l],a=n.getMeta(t);if(a?.isSVG&&Me[l])e.setAttributeNS(Me[l],l,o);else if(t.tagName==="CANVAS"&&l==="rr_dataURL"){const s=document.createElement("img");s.src=o,s.onload=()=>{const c=e.getContext("2d");c&&c.drawImage(s,0,0,s.width,s.height)}}else e.setAttribute(l,o)}for(const{name:l}of Array.from(r))l in i||e.removeAttribute(l);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}function Ze(e,t,n,r,i){let l=0,o=e.length-1,a=0,s=t.length-1,c=e[l],u=e[o],p=t[a],d=t[s],f,E;for(;l<=o&&a<=s;)if(c===void 0)c=e[++l];else if(u===void 0)u=e[--o];else if(te(c,p,r.mirror,i))Y(c,p,r,i),c=e[++l],p=t[++a];else if(te(u,d,r.mirror,i))Y(u,d,r,i),u=e[--o],d=t[--s];else if(te(c,d,r.mirror,i)){try{n.insertBefore(c,u.nextSibling)}catch(g){console.warn(g)}Y(c,d,r,i),c=e[++l],d=t[--s]}else if(te(u,p,r.mirror,i)){try{n.insertBefore(u,c)}catch(g){console.warn(g)}Y(u,p,r,i),u=e[--o],p=t[++a]}else{if(!f){f={};for(let v=l;v<=o;v++){const h=e[v];h&&r.mirror.hasNode(h)&&(f[r.mirror.getId(h)]=v)}}E=f[i.getId(p)];const g=e[E];if(E!==void 0&&g&&te(g,p,r.mirror,i)){try{n.insertBefore(g,c)}catch(v){console.warn(v)}Y(g,p,r,i),e[E]=void 0}else{const v=ge(p,r.mirror,i);n.nodeName==="#document"&&c&&(v.nodeType===v.DOCUMENT_TYPE_NODE&&c.nodeType===c.DOCUMENT_TYPE_NODE||v.nodeType===v.ELEMENT_NODE&&c.nodeType===c.ELEMENT_NODE)&&(n.removeChild(c),r.mirror.removeNodeFromMap(c),c=e[++l]);try{n.insertBefore(v,c||null),Y(v,p,r,i)}catch(h){console.warn(h)}}p=t[++a]}if(l>o){const g=t[s+1];let v=null;for(g&&(v=r.mirror.getNode(i.getId(g)));a<=s;++a){const h=ge(t[a],r.mirror,i);try{n.insertBefore(h,v),Y(h,t[a],r,i)}catch(N){console.warn(N)}}}else if(a>s)for(;l<=o;l++){const g=e[l];if(!(!g||g.parentNode!==n))try{n.removeChild(g),r.mirror.removeNodeFromMap(g)}catch(v){console.warn(v)}}}function ge(e,t,n){const r=n.getId(e),i=n.getMeta(e);let l=null;if(r>-1&&(l=t.getNode(r)),l!==null&&Ce(l,e))return l;switch(e.RRNodeType){case S.Document:l=new Document;break;case S.DocumentType:l=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case S.Element:{let o=e.tagName.toLowerCase();o=ln[o]||o,i&&"isSVG"in i&&i?.isSVG?l=document.createElementNS(Me.svg,o):l=document.createElement(e.tagName);break}case S.Text:l=document.createTextNode(e.data);break;case S.Comment:l=document.createComment(e.data);break;case S.CDATA:l=document.createCDATASection(e.data);break}i&&t.add(l,Object.assign({},i));try{G?.add(l)}catch{}return l}function Ce(e,t){return e.nodeType!==t.nodeType?!1:e.nodeType!==e.ELEMENT_NODE||e.tagName.toUpperCase()===t.tagName}function te(e,t,n,r){const i=n.getId(e),l=r.getId(t);return i===-1||i!==l?!1:Ce(e,t)}class ne extends on(B){constructor(t){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=Tn(),this.scrollData=null,t&&(this.mirror=t)}get unserializedId(){return this._unserializedId--}createDocument(t,n,r){return new ne}createDocumentType(t,n,r){const i=new hn(t,n,r);return i.ownerDocument=this,i}createElement(t){const n=t.toUpperCase();let r;switch(n){case"AUDIO":case"VIDEO":r=new pn(n);break;case"IFRAME":r=new gn(n,this.mirror);break;case"CANVAS":r=new mn(n);break;case"STYLE":r=new fn(n);break;default:r=new le(n);break}return r.ownerDocument=this,r}createComment(t){const n=new vn(t);return n.ownerDocument=this,n}createCDATASection(t){const n=new Nn(t);return n.ownerDocument=this,n}createTextNode(t){const n=new yn(t);return n.ownerDocument=this,n}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const hn=He(B);class le extends ze(B){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class pn extends sn(le){}class mn extends le{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class fn extends le{constructor(){super(...arguments),this.rules=[]}}class gn extends le{constructor(t,n){super(t),this.contentDocument=new ne,this.contentDocument.mirror=n}}const yn=Xe(B),vn=Qe(B),Nn=qe(B);function En(e){return e instanceof HTMLFormElement?"FORM":e.tagName.toUpperCase()}function et(e,t,n,r){let i;switch(e.nodeType){case k.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?i=r.contentDocument:(i=t,i.compatMode=e.compatMode);break;case k.DOCUMENT_TYPE_NODE:{const o=e;i=t.createDocumentType(o.name,o.publicId,o.systemId);break}case k.ELEMENT_NODE:{const o=e,a=En(o);i=t.createElement(a);const s=i;for(const{name:c,value:u}of Array.from(o.attributes))s.attributes[c]=u;o.scrollLeft&&(s.scrollLeft=o.scrollLeft),o.scrollTop&&(s.scrollTop=o.scrollTop);break}case k.TEXT_NODE:i=t.createTextNode(e.textContent||"");break;case k.CDATA_SECTION_NODE:i=t.createCDATASection(e.data);break;case k.COMMENT_NODE:i=t.createComment(e.textContent||"");break;case k.DOCUMENT_FRAGMENT_NODE:i=r.attachShadow({mode:"open"});break;default:return null}let l=n.getMeta(e);return t instanceof ne&&(l||(l=tt(i,t.unserializedId),n.add(e,l)),t.mirror.add(i,Object.assign({},l))),i}function wn(e,t=Kt(),n=new ne){function r(i,l){const o=et(i,n,t,l);if(o!==null)if(l?.nodeName!=="IFRAME"&&i.nodeType!==k.DOCUMENT_FRAGMENT_NODE&&(l?.appendChild(o),o.parentNode=l,o.parentElement=l),i.nodeName==="IFRAME"){const a=i.contentDocument;a&&r(a,o)}else(i.nodeType===k.DOCUMENT_NODE||i.nodeType===k.ELEMENT_NODE||i.nodeType===k.DOCUMENT_FRAGMENT_NODE)&&(i.nodeType===k.ELEMENT_NODE&&i.shadowRoot&&r(i.shadowRoot,o),i.childNodes.forEach(a=>r(a,o)))}return r(e,null),n}function Tn(){return new Sn}class Sn{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){const r=this.getNode(t);if(r){const i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function tt(e,t){switch(e.RRNodeType){case S.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case S.DocumentType:{const n=e;return{id:t,type:e.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case S.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case S.Text:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function nt(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(i){i(n)}),(r=e.get("*"))&&r.slice().map(function(i){i(t,n)})}}}var Dn=Object.freeze({__proto__:null,default:nt});function bn(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const n=e.HTMLElement||e.Element,r=468,i={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||s,scrollIntoView:n.prototype.scrollIntoView},l=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;function o(h){const N=["MSIE ","Trident/","Edge/"];return new RegExp(N.join("|")).test(h)}const a=o(e.navigator.userAgent)?1:0;function s(h,N){this.scrollLeft=h,this.scrollTop=N}function c(h){return .5*(1-Math.cos(Math.PI*h))}function u(h){if(h===null||typeof h!="object"||h.behavior===void 0||h.behavior==="auto"||h.behavior==="instant")return!0;if(typeof h=="object"&&h.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+h.behavior+" is not a valid value for enumeration ScrollBehavior.")}function p(h,N){if(N==="Y")return h.clientHeight+a<h.scrollHeight;if(N==="X")return h.clientWidth+a<h.scrollWidth}function d(h,N){const w=e.getComputedStyle(h,null)["overflow"+N];return w==="auto"||w==="scroll"}function f(h){const N=p(h,"Y")&&d(h,"Y"),w=p(h,"X")&&d(h,"X");return N||w}function E(h){for(;h!==t.body&&f(h)===!1;)h=h.parentNode||h.host;return h}function g(h){const N=l();let w,T,C,I=(N-h.startTime)/r;I=I>1?1:I,w=c(I),T=h.startX+(h.x-h.startX)*w,C=h.startY+(h.y-h.startY)*w,h.method.call(h.scrollable,T,C),(T!==h.x||C!==h.y)&&e.requestAnimationFrame(g.bind(e,h))}function v(h,N,w){let T,C,I,V;const F=l();h===t.body?(T=e,C=e.scrollX||e.pageXOffset,I=e.scrollY||e.pageYOffset,V=i.scroll):(T=h,C=h.scrollLeft,I=h.scrollTop,V=s),g({scrollable:T,method:V,startTime:F,startX:C,startY:I,x:N,y:w})}e.scroll=e.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset);return}v.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset)}},e.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){i.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}v.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const h=arguments[0].left,N=arguments[0].top;v.call(this,this,typeof h>"u"?this.scrollLeft:~~h,typeof N>"u"?this.scrollTop:~~N)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){i.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const h=E(this),N=h.getBoundingClientRect(),w=this.getBoundingClientRect();h!==t.body?(v.call(this,h,h.scrollLeft+w.left-N.left,h.scrollTop+w.top-N.top),e.getComputedStyle(h).position!=="fixed"&&e.scrollBy({left:N.left,top:N.top,behavior:"smooth"})):e.scrollBy({left:w.left,top:w.top,behavior:"smooth"})}}var O=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(O||{}),b=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(b||{}),L=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(L||{}),ye=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(ye||{}),ve=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(ve||{}),M=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(M||{});class Mn{constructor(t=[],n){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=n.speed}addAction(t){const n=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=t.delay)this.actions.push(t);else{const r=this.findActionIndex(t);this.actions.splice(r,0,t)}n&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){const t=performance.now();for(this.timeOffset+=(t-this.lastTimestamp)*this.speed,this.lastTimestamp=t;this.actions.length;){const n=this.actions[0];if(this.timeOffset>=n.delay)this.actions.shift(),n.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}isActive(){return this.raf!==null}findActionIndex(t){let n=0,r=this.actions.length-1;for(;n<=r;){const i=Math.floor((n+r)/2);if(this.actions[i].delay<t.delay)n=i+1;else if(this.actions[i].delay>t.delay)r=i-1;else return i+1}return n}}function rt(e,t){if(e.type===O.IncrementalSnapshot&&e.data.source===b.MouseMove&&e.data.positions&&e.data.positions.length){const n=e.data.positions[0].timeOffset,r=e.timestamp+n;return e.delay=r-t,r-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function it(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,i,l=n.call(e),o=[];try{for(;(t===void 0||t-- >0)&&!(r=l.next()).done;)o.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}return o}var re;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(re||(re={}));var ot={type:"xstate.init"};function Re(e){return e===void 0?[]:[].concat(e)}function ie(e){return{type:"xstate.assign",assignment:e}}function st(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function Ne(e){return function(t){return e===t}}function at(e){return typeof e=="string"?{type:e}:e}function lt(e,t){return{value:e,context:t,actions:[],changed:!1,matches:Ne(e)}}function ct(e,t,n){var r=t,i=!1;return[e.filter(function(l){if(l.type==="xstate.assign"){i=!0;var o=Object.assign({},r);return typeof l.assignment=="function"?o=l.assignment(r,n):Object.keys(l.assignment).forEach(function(a){o[a]=typeof l.assignment[a]=="function"?l.assignment[a](r,n):l.assignment[a]}),r=o,!1}return!0}),r,i]}function ut(e,t){t===void 0&&(t={});var n=it(ct(Re(e.states[e.initial].entry).map(function(o){return st(o,t.actions)}),e.context,ot),2),r=n[0],i=n[1],l={config:e,_options:t,initialState:{value:e.initial,actions:r,context:i,matches:Ne(e.initial)},transition:function(o,a){var s,c,u=typeof o=="string"?{value:o,context:e.context}:o,p=u.value,d=u.context,f=at(a),E=e.states[p];if(E.on){var g=Re(E.on[f.type]);try{for(var v=function(_){var ee=typeof Symbol=="function"&&Symbol.iterator,y=ee&&_[ee],m=0;if(y)return y.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&m>=_.length&&(_=void 0),{value:_&&_[m++],done:!_}}};throw new TypeError(ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(g),h=v.next();!h.done;h=v.next()){var N=h.value;if(N===void 0)return lt(p,d);var w=typeof N=="string"?{target:N}:N,T=w.target,C=w.actions,I=C===void 0?[]:C,V=w.cond,F=V===void 0?function(){return!0}:V,Z=T===void 0,pe=T??p,me=e.states[pe];if(F(d,f)){var q=it(ct((Z?Re(I):[].concat(E.exit,I,me.entry).filter(function(_){return _})).map(function(_){return st(_,l._options.actions)}),d,f),3),j=q[0],J=q[1],se=q[2],U=T??p;return{value:U,context:J,actions:j,changed:T!==p||j.length>0||se,matches:Ne(U)}}}}catch(_){s={error:_}}finally{try{h&&!h.done&&(c=v.return)&&c.call(v)}finally{if(s)throw s.error}}}return lt(p,d)}};return l}var dt=function(e,t){return e.actions.forEach(function(n){var r=n.exec;return r&&r(e.context,t)})};function ht(e){var t=e.initialState,n=re.NotStarted,r=new Set,i={_machine:e,send:function(l){n===re.Running&&(t=e.transition(t,l),dt(t,at(l)),r.forEach(function(o){return o(t)}))},subscribe:function(l){return r.add(l),l(t),{unsubscribe:function(){return r.delete(l)}}},start:function(l){if(l){var o=typeof l=="object"?l:{context:e.config.context,value:l};t={value:o.value,actions:[],context:o.context,matches:Ne(o.value)}}return n=re.Running,dt(t,ot),i},stop:function(){return n=re.Stopped,r.clear(),i},get state(){return t},get status(){return n}};return i}var Cn=Object.defineProperty,Rn=Object.defineProperties,xn=Object.getOwnPropertyDescriptors,pt=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,In=Object.prototype.propertyIsEnumerable,mt=(e,t,n)=>t in e?Cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xe=(e,t)=>{for(var n in t||(t={}))An.call(t,n)&&mt(e,n,t[n]);if(pt)for(var n of pt(t))In.call(t,n)&&mt(e,n,t[n]);return e},Ae=(e,t)=>Rn(e,xn(t));function On(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.type===O.Meta&&r.timestamp<=t)return e.slice(n)}return e}function kn(e,{getCastFn:t,applyEventsSynchronously:n,emitter:r}){const i=ut({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:ie({lastPlayedEvent:(l,o)=>o.type==="CAST_EVENT"?o.payload.event:l.lastPlayedEvent}),recordTimeOffset:ie((l,o)=>{let a=l.timeOffset;return"payload"in o&&"timeOffset"in o.payload&&(a=o.payload.timeOffset),Ae(xe({},l),{timeOffset:a,baselineTime:l.events[0].timestamp+a})}),play(l){var o;const{timer:a,events:s,baselineTime:c,lastPlayedEvent:u}=l;a.clear();for(const E of s)rt(E,c);const p=On(s,c);let d=u?.timestamp;u?.type===O.IncrementalSnapshot&&u.data.source===b.MouseMove&&(d=u.timestamp+((o=u.data.positions[0])==null?void 0:o.timeOffset)),c<(d||0)&&r.emit(M.PlayBack);const f=new Array;for(const E of p)if(!(d&&d<c&&(E.timestamp<=d||E===u)))if(E.timestamp<c)f.push(E);else{const g=t(E,!1);a.addAction({doAction:()=>{g()},delay:E.delay})}n(f),r.emit(M.Flush),a.start()},pause(l){l.timer.clear()},resetLastPlayedEvent:ie(l=>Ae(xe({},l),{lastPlayedEvent:null})),startLive:ie({baselineTime:(l,o)=>(l.timer.start(),o.type==="TO_LIVE"&&o.payload.baselineTime?o.payload.baselineTime:Date.now())}),addEvent:ie((l,o)=>{const{baselineTime:a,timer:s,events:c}=l;if(o.type==="ADD_EVENT"){const{event:u}=o.payload;rt(u,a);let p=c.length-1;if(!c[p]||c[p].timestamp<=u.timestamp)c.push(u);else{let E=-1,g=0;for(;g<=p;){const v=Math.floor((g+p)/2);c[v].timestamp<=u.timestamp?g=v+1:p=v-1}E===-1&&(E=g),c.splice(E,0,u)}const d=u.timestamp<a,f=t(u,d);d?f():s.isActive()&&s.addAction({doAction:()=>{f()},delay:u.delay})}return Ae(xe({},l),{events:c})})}});return ht(i)}function _n(e){const t=ut({id:"speed",context:e,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(n,r)=>{"payload"in r&&n.timer.setSpeed(r.payload.speed)},recordSpeed:ie({normalSpeed:n=>n.timer.speed}),restoreSpeed:n=>{n.timer.setSpeed(n.normalSpeed)}}});return ht(t)}const oe=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let ft={map:{},getId(){return console.error(oe),-1},getNode(){return console.error(oe),null},removeNodeFromMap(){console.error(oe)},has(){return console.error(oe),!1},reset(){console.error(oe)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(ft=new Proxy(ft,{get(e,t,n){return t==="map"&&console.error(oe),Reflect.get(e,t,n)}}));function Ln(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function Fn(e){const t={},n=(i,l)=>{const o={value:i,parent:l,children:[]};return t[i.node.id]=o,o},r=[];for(const i of e){const{nextId:l,parentId:o}=i;if(l&&l in t){const a=t[l];if(a.parent){const s=a.parent.children.indexOf(a);a.parent.children.splice(s,0,n(i,a.parent))}else{const s=r.indexOf(a);r.splice(s,0,n(i,null))}continue}if(o in t){const a=t[o];a.children.push(n(i,a));continue}r.push(n(i,null))}return r}function gt(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)gt(e.children[n],t)}function Ie(e,t){return Boolean(e.nodeName==="IFRAME"&&t.getMeta(e))}function yt(e,t){var n,r;const i=(r=(n=e.ownerDocument)==null?void 0:n.defaultView)==null?void 0:r.frameElement;if(!i||i===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const l=i.getBoundingClientRect(),o=yt(i,t),a=l.height/i.clientHeight;return{x:l.x*o.relativeScale+o.x,y:l.y*o.relativeScale+o.y,relativeScale:a,absoluteScale:o.absoluteScale*a}}function Ee(e){return Boolean(e?.shadowRoot)}function ce(e,t){const n=e[t[0]];return t.length===1?n:ce(n.cssRules[t[1]].cssRules,t.slice(2))}function vt(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function Pn(e){const t=new Set,n=[];for(let r=e.length;r--;){const i=e[r];t.has(i.id)||(n.push(i),t.add(i.id))}return n}class Un{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var n;return(n=this.styleIDMap.get(t))!=null?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}const Bn=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"];for(var Nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ue=typeof Uint8Array>"u"?[]:new Uint8Array(256),we=0;we<Nt.length;we++)ue[Nt.charCodeAt(we)]=we;var $n=function(e){var t=e.length*.75,n=e.length,r,i=0,l,o,a,s;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var c=new ArrayBuffer(t),u=new Uint8Array(c);for(r=0;r<n;r+=4)l=ue[e.charCodeAt(r)],o=ue[e.charCodeAt(r+1)],a=ue[e.charCodeAt(r+2)],s=ue[e.charCodeAt(r+3)],u[i++]=l<<2|o>>4,u[i++]=(o&15)<<4|a>>2,u[i++]=(a&3)<<6|s&63;return c},Vn=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});const Et=new Map;function wt(e,t){let n=Et.get(e);return n||(n=new Map,Et.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}function z(e,t,n){return r=>Vn(this,null,function*(){if(r&&typeof r=="object"&&"rr_type"in r)if(n&&(n.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){const i=yield z(e,t,n)(r.args);return yield createImageBitmap.apply(null,i)}else if("index"in r){if(n||t===null)return r;const{rr_type:i,index:l}=r;return wt(t,i)[l]}else if("args"in r){const{rr_type:i,args:l}=r,o=window[i];return new o(...yield Promise.all(l.map(z(e,t,n))))}else{if("base64"in r)return $n(r.base64);if("src"in r){const i=e.get(r.src);if(i)return i;{const l=new Image;return l.src=r.src,e.set(r.src,l),l}}else if("data"in r&&r.rr_type==="Blob"){const i=yield Promise.all(r.data.map(z(e,t,n)));return new Blob(i,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map(z(e,t,n)));return r})}var Wn=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});function jn(e,t){try{return t===ye.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}const Gn=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Yn(e,t){if(!(t!=null&&t.constructor))return;const{name:n}=t.constructor;if(!Gn.includes(n))return;const r=wt(e,n);r.includes(t)||r.push(t)}function Hn(e){return Wn(this,arguments,function*({mutation:t,target:n,type:r,imageMap:i,errorHandler:l}){try{const o=jn(n,r);if(!o)return;if(t.setter){o[t.property]=t.args[0];return}const a=o[t.property],s=yield Promise.all(t.args.map(z(i,o))),c=a.apply(o,s);Yn(o,c)}catch(o){l(t,o)}})}var zn=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});function Xn(e){return zn(this,arguments,function*({event:t,mutation:n,target:r,imageMap:i,errorHandler:l}){try{const o=r.getContext("2d");if(n.setter){o[n.property]=n.args[0];return}const a=o[n.property];if(n.property==="drawImage"&&typeof n.args[0]=="string")i.get(t),a.apply(o,n.args);else{const s=yield Promise.all(n.args.map(z(i,o)));a.apply(o,s)}}catch(o){l(n,o)}})}var Qn=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});function Tt(e){return Qn(this,arguments,function*({event:t,mutation:n,target:r,imageMap:i,canvasEventMap:l,errorHandler:o}){try{const a=l.get(t)||n,s="commands"in a?a.commands:[a];if([ye.WebGL,ye.WebGL2].includes(n.type)){for(let c=0;c<s.length;c++){const u=s[c];yield Hn({mutation:u,type:n.type,target:r,imageMap:i,errorHandler:o})}return}for(let c=0;c<s.length;c++){const u=s[c];yield Xn({event:t,mutation:u,target:r,imageMap:i,errorHandler:o})}}catch(a){o(n,a)}})}var qn=Object.defineProperty,Jn=Object.defineProperties,Kn=Object.getOwnPropertyDescriptors,St=Object.getOwnPropertySymbols,Zn=Object.prototype.hasOwnProperty,er=Object.prototype.propertyIsEnumerable,Dt=(e,t,n)=>t in e?qn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Te=(e,t)=>{for(var n in t||(t={}))Zn.call(t,n)&&Dt(e,n,t[n]);if(St)for(var n of St(t))er.call(t,n)&&Dt(e,n,t[n]);return e},Oe=(e,t)=>Jn(e,Kn(t)),ke=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});const tr=10*1e3,nr=5*1e3,rr=nt||Dn,bt="[replayer]",_e={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Mt(e){return e.type==O.IncrementalSnapshot&&(e.data.source==b.TouchMove||e.data.source==b.MouseInteraction&&e.data.type==L.TouchStart)}class ir{constructor(t,n){if(this.usingVirtualDom=!1,this.virtualDom=new ne,this.mouseTail=null,this.tailPositions=[],this.emitter=rr(),this.legacy_missingNodeRetryMap={},this.cache=Ge(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Vt(),this.styleMirror=new Un,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=a=>{this.iframe.style.display="inherit";for(const s of[this.mouseTail,this.iframe])!s||(s.setAttribute("width",String(a.width)),s.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(const s of a){switch(s.type){case O.DomContentLoaded:case O.Load:case O.Custom:continue;case O.FullSnapshot:case O.Meta:case O.Plugin:case O.IncrementalSnapshot:break}this.getCastFn(s,!0)()}},this.getCastFn=(a,s=!1)=>{let c;switch(a.type){case O.DomContentLoaded:case O.Load:break;case O.Custom:c=()=>{this.emitter.emit(M.CustomEvent,a)};break;case O.Meta:c=()=>this.emitter.emit(M.Resize,{width:a.data.width,height:a.data.height});break;case O.FullSnapshot:c=()=>{var u;if(this.firstFullSnapshot){if(this.firstFullSnapshot===a){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,s),(u=this.iframe.contentWindow)==null||u.scrollTo(a.data.initialOffset),this.styleMirror.reset()};break;case O.IncrementalSnapshot:c=()=>{if(this.applyIncremental(a,s),!s&&(a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const u of this.service.state.context.events)if(!(u.timestamp<=a.timestamp)&&this.isUserInteraction(u)){u.delay-a.delay>tr*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){const u=this.nextUserInteractionEvent.delay-a.delay,p={speed:Math.min(Math.round(u/nr),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:p}),this.emitter.emit(M.SkipStart,p)}}};break}return()=>{c&&c();for(const p of this.config.plugins||[])p.handler&&p.handler(a,s,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});const u=this.service.state.context.events.length-1;if(!this.config.liveMode&&a===this.service.state.context.events[u]){const p=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(M.Finish))};let d=50;a.type===O.IncrementalSnapshot&&a.data.source===b.MouseMove&&a.data.positions.length&&(d+=Math.max(0,-a.data.positions[0].timeOffset)),setTimeout(p,d)}this.emitter.emit(M.EventCast,a)}},!(n!=null&&n.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:_e,useVirtualDom:!0,logger:console};this.config=Object.assign({},r,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(M.Resize,this.handleResize),this.setupDom();for(const a of this.config.plugins||[])a.getMirror&&a.getMirror({nodeMirror:this.mirror});this.emitter.on(M.Flush,()=>{if(this.usingVirtualDom){const a={mirror:this.mirror,applyCanvas:(s,c,u)=>{Tt({event:s,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(s,c)=>{s.source===b.StyleSheetRule?this.applyStyleSheetRule(s,c):s.source===b.StyleDeclaration&&this.applyStyleDeclaration(s,c)},afterAppend:(s,c)=>{for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(s,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{Y(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror)}catch(s){console.warn(s)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const s in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[s],u=ge(c.node,this.mirror,this.virtualDom.mirror);Y(u,c.node,a,this.virtualDom.mirror),c.node=u}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(s=>{this.applyStyleSheetMutation(s)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(s=>{this.applyAdoptedStyleSheet(s)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){const[a,s]=this.lastMouseDownEvent;a.dispatchEvent(s)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(M.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});const i=new Mn([],{speed:this.config.speed});this.service=kn({events:t.map(a=>n&&n.unpackFn?n.unpackFn(a):a).sort((a,s)=>a.timestamp-s.timestamp),timer:i,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(M.StateChange,{player:a})}),this.speedService=_n({normalSpeed:-1,timer:i}),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(M.StateChange,{speed:a})});const l=this.service.state.context.events.find(a=>a.type===O.Meta),o=this.service.state.context.events.find(a=>a.type===O.FullSnapshot);if(l){const{width:a,height:s}=l.data;setTimeout(()=>{this.emitter.emit(M.Resize,{width:a,height:s})},0)}o&&setTimeout(()=>{var a;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),(a=this.iframe.contentWindow)==null||a.scrollTo(o.data.initialOffset))},1),this.service.state.context.events.find(Mt)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(t,n){return this.emitter.on(t,n),this}off(t,n){return this.emitter.off(t,n),this}setConfig(t){Object.keys(t).forEach(n=>{t[n],this.config[n]=t[n]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:n.timestamp,totalTime:n.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:n}=this.service.state.context;return t-n[0].timestamp}getMirror(){return this.mirror}play(t=0){var n,r;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:t}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.remove("rrweb-paused"),this.emitter.emit(M.Start)}pause(t){var n,r;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.add("rrweb-paused"),this.emitter.emit(M.Pause)}resume(t=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(M.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(M.Destroy)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const n=this.config.unpackFn?this.config.unpackFn(t):t;Mt(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Ge()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(bn(this.iframe.contentWindow,this.iframe.contentDocument),Ln(this.iframe.contentWindow))}rebuildFullSnapshot(t,n=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[],i=(a,s)=>{this.collectIframeAndAttachDocument(r,a);for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(a,{id:s,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),qt(t.data.node,{doc:this.iframe.contentDocument,afterAppend:i,cache:this.cache,mirror:this.mirror}),i(this.iframe.contentDocument,t.data.node.id);for(const{mutationInQueue:a,builtNode:s}of r)this.attachDocumentToIframe(a,s),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==a);const{documentElement:l,head:o}=this.iframe.contentDocument;this.insertStyleRules(l,o),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(M.FullsnapshotRebuilded,t),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,n){var r;const i=Bn(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&i.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const l=this.virtualDom.createElement("style");this.virtualDom.mirror.add(l,tt(l,this.virtualDom.unserializedId)),t.insertBefore(l,n),l.rules.push({source:b.StyleSheetRule,adds:i.map((o,a)=>({rule:o,index:a}))})}else{const l=document.createElement("style");t.insertBefore(l,n);for(let o=0;o<i.length;o++)(r=l.sheet)==null||r.insertRule(i[o],o)}}attachDocumentToIframe(t,n){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,i=[],l=(o,a)=>{this.collectIframeAndAttachDocument(i,o);const s=r.getMeta(o);if(s?.type===R.Element&&s?.tagName.toUpperCase()==="HTML"){const{documentElement:c,head:u}=n.contentDocument;this.insertStyleRules(c,u)}if(!this.usingVirtualDom)for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(o,{id:a,replayer:this})};ae(t.node,{doc:n.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:l,cache:this.cache}),l(n.contentDocument,t.node.id);for(const{mutationInQueue:o,builtNode:a}of i)this.attachDocumentToIframe(o,a),this.newDocumentQueue=this.newDocumentQueue.filter(s=>s!==o)}collectIframeAndAttachDocument(t,n){if(Ie(n,this.mirror)){const r=this.newDocumentQueue.find(i=>i.parentId===this.mirror.getId(n));r&&t.push({mutationInQueue:r,builtNode:n})}}waitForStylesheetLoad(){var t;const n=(t=this.iframe.contentDocument)==null?void 0:t.head;if(n){const r=new Set;let i,l=this.service.state;const o=()=>{l=this.service.state};this.emitter.on(M.Start,o),this.emitter.on(M.Pause,o);const a=()=>{this.emitter.off(M.Start,o),this.emitter.off(M.Pause,o)};n.querySelectorAll('link[rel="stylesheet"]').forEach(s=>{s.sheet||(r.add(s),s.addEventListener("load",()=>{r.delete(s),r.size===0&&i!==-1&&(l.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(M.LoadStylesheetEnd),i&&clearTimeout(i),a())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(M.LoadStylesheetStart),i=setTimeout(()=>{l.matches("playing")&&this.play(this.getCurrentTime()),i=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return ke(this,null,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(M.Start,t),this.emitter.on(M.Pause,t);const n=[];for(const r of this.service.state.context.events)r.type===O.IncrementalSnapshot&&r.data.source===b.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(i=>{this.preloadImages(i,r)}));return Promise.all(n)})}preloadImages(t,n){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(n)){const r=document.createElement("canvas"),i=r.getContext("2d"),l=i?.createImageData(r.width,r.height);l?.data,JSON.parse(t.args[0]),i?.putImageData(l,0,0)}}deserializeAndPreloadCanvasEvents(t,n){return ke(this,null,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};if("commands"in t){const i=yield Promise.all(t.commands.map(l=>ke(this,null,function*(){const o=yield Promise.all(l.args.map(z(this.imageMap,null,r)));return Oe(Te({},l),{args:o})})));r.isUnchanged===!1&&this.canvasEventMap.set(n,Oe(Te({},t),{commands:i}))}else{const i=yield Promise.all(t.args.map(z(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(n,Oe(Te({},t),{args:i}))}}})}applyIncremental(t,n){var r,i,l;const{data:o}=t;switch(o.source){case b.Mutation:{try{this.applyMutation(o,n)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,o)}break}case b.Drag:case b.TouchMove:case b.MouseMove:if(n){const a=o.positions[o.positions.length-1];this.mousePos={x:a.x,y:a.y,id:a.id,debugData:o}}else o.positions.forEach(a=>{const s={doAction:()=>{this.moveAndHover(a.x,a.y,a.id,n,o)},delay:a.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(s)}),this.timer.addAction({doAction(){},delay:t.delay-((r=o.positions[0])==null?void 0:r.timeOffset)});break;case b.MouseInteraction:{if(o.id===-1)break;const a=new Event(L[o.type].toLowerCase()),s=this.mirror.getNode(o.id);if(!s)return this.debugNodeNotFound(o,o.id);this.emitter.emit(M.MouseInteraction,{type:o.type,target:s});const{triggerFocus:c}=this.config;switch(o.type){case L.Blur:"blur"in s&&s.blur();break;case L.Focus:c&&s.focus&&s.focus({preventScroll:!0});break;case L.Click:case L.TouchStart:case L.TouchEnd:case L.MouseDown:case L.MouseUp:n?(o.type===L.TouchStart?this.touchActive=!0:o.type===L.TouchEnd&&(this.touchActive=!1),o.type===L.MouseDown?this.lastMouseDownEvent=[s,a]:o.type===L.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===L.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,n,o),o.type===L.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===L.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===L.TouchEnd?this.mouse.classList.remove("touch-active"):s.dispatchEvent(a));break;case L.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:s.dispatchEvent(a)}break}case b.Scroll:{if(o.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.scrollData=o;break}this.applyScroll(o,n);break}case b.ViewportResize:this.emitter.emit(M.Resize,{width:o.width,height:o.height});break;case b.Input:{if(o.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.inputData=o;break}this.applyInput(o);break}case b.MediaInteraction:{const a=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);const s=a;try{o.currentTime!==void 0&&(s.currentTime=o.currentTime),o.volume!==void 0&&(s.volume=o.volume),o.muted!==void 0&&(s.muted=o.muted),o.type===ve.Pause&&s.pause(),o.type===ve.Play&&s.play(),o.type===ve.RateChange&&(s.playbackRate=o.playbackRate)}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case b.StyleSheetRule:case b.StyleDeclaration:{this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&((i=this.virtualDom.mirror.getNode(o.id))==null||i.rules.push(o)):this.applyStyleSheetMutation(o);break}case b.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.canvasMutations.push({event:t,mutation:o})}else{const a=this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);Tt({event:t,mutation:o,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case b.Font:{try{const a=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);(l=this.iframe.contentDocument)==null||l.fonts.add(a)}catch(a){this.warn(a)}break}case b.Selection:{if(n){this.lastSelectionData=o;break}this.applySelection(o);break}case b.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o);break}}}applyMutation(t,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,wn(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const c in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[c],p=et(u.node,this.virtualDom,this.mirror);p&&(u.node=p)}catch(u){this.warn(u)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes=t.removes.filter(c=>r.getNode(c.id)?!0:(this.warnNodeNotFound(t,c.id),!1)),t.removes.forEach(c=>{var u;const p=r.getNode(c.id);if(!p)return;let d=r.getNode(c.parentId);if(!d)return this.warnNodeNotFound(t,c.parentId);if(c.isShadow&&Ee(d)&&(d=d.shadowRoot),r.removeNodeFromMap(p),d)try{d.removeChild(p),this.usingVirtualDom&&p.nodeName==="#text"&&d.nodeName==="STYLE"&&((u=d.rules)==null?void 0:u.length)>0&&(d.rules=[])}catch(f){if(f instanceof DOMException)this.warn("parent could not remove child in mutation",d,p,t);else throw f}});const i=Te({},this.legacy_missingNodeRetryMap),l=[],o=c=>{let u=null;return c.nextId&&(u=r.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},a=c=>{var u,p;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let d=r.getNode(c.parentId);if(!d)return c.node.type===R.Document?this.newDocumentQueue.push(c):l.push(c);c.node.isShadow&&(Ee(d)||d.attachShadow({mode:"open"}),d=d.shadowRoot);let f=null,E=null;if(c.previousId&&(f=r.getNode(c.previousId)),c.nextId&&(E=r.getNode(c.nextId)),o(c))return l.push(c);if(c.node.rootId&&!r.getNode(c.node.rootId))return;const g=c.node.rootId?r.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Ie(d,r)){this.attachDocumentToIframe(c,d);return}const v=(w,T)=>{if(!this.usingVirtualDom)for(const C of this.config.plugins||[])C.onBuild&&C.onBuild(w,{id:T,replayer:this})},h=ae(c.node,{doc:g,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:v});if(c.previousId===-1||c.nextId===-1){i[c.node.id]={node:h,mutation:c};return}const N=r.getMeta(d);if(N&&N.type===R.Element&&N.tagName==="textarea"&&c.node.type===R.Text){const w=Array.isArray(d.childNodes)?d.childNodes:Array.from(d.childNodes);for(const T of w)T.nodeType===d.TEXT_NODE&&d.removeChild(T)}else if(N?.type===R.Document){const w=d;c.node.type===R.DocumentType&&((u=w.childNodes[0])==null?void 0:u.nodeType)===Node.DOCUMENT_TYPE_NODE&&w.removeChild(w.childNodes[0]),h.nodeName==="HTML"&&w.documentElement&&w.removeChild(w.documentElement)}if(f&&f.nextSibling&&f.nextSibling.parentNode?d.insertBefore(h,f.nextSibling):E&&E.parentNode?d.contains(E)?d.insertBefore(h,E):d.insertBefore(h,null):d.appendChild(h),v(h,c.node.id),this.usingVirtualDom&&h.nodeName==="#text"&&d.nodeName==="STYLE"&&((p=d.rules)==null?void 0:p.length)>0&&(d.rules=[]),Ie(h,this.mirror)){const w=this.mirror.getId(h),T=this.newDocumentQueue.find(C=>C.parentId===w);T&&(this.attachDocumentToIframe(T,h),this.newDocumentQueue=this.newDocumentQueue.filter(C=>C!==T))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(i,d,h,c)};t.adds.forEach(c=>{a(c)});const s=Date.now();for(;l.length;){const c=Fn(l);if(l.length=0,Date.now()-s>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(const u of c)r.getNode(u.value.parentId)?gt(u,p=>{a(p)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(i).length&&Object.assign(this.legacy_missingNodeRetryMap,i),Pn(t.texts).forEach(c=>{var u;const p=r.getNode(c.id);if(!p)return t.removes.find(d=>d.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);if(p.textContent=c.value,this.usingVirtualDom){const d=p.parentNode;((u=d?.rules)==null?void 0:u.length)>0&&(d.rules=[])}}),t.attributes.forEach(c=>{const u=r.getNode(c.id);if(!u)return t.removes.find(p=>p.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);for(const p in c.attributes)if(typeof p=="string"){const d=c.attributes[p];if(d===null)u.removeAttribute(p);else if(typeof d=="string")try{if(p==="_cssText"&&(u.nodeName==="LINK"||u.nodeName==="STYLE"))try{const f=r.getMeta(u);Object.assign(f.attributes,c.attributes);const E=ae(f,{doc:u.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),g=u.nextSibling,v=u.parentNode;if(E&&v){v.removeChild(u),v.insertBefore(E,g),r.replace(c.id,E);break}}catch{}u.setAttribute(p,d)}catch(f){this.warn("An error occurred may due to the checkout feature.",f)}else if(p==="style"){const f=d,E=u;for(const g in f)if(f[g]===!1)E.style.removeProperty(g);else if(f[g]instanceof Array){const v=f[g];E.style.setProperty(g,v[0],v[1])}else{const v=f[g];E.style.setProperty(g,v)}}}})}applyScroll(t,n){var r,i;const l=this.mirror.getNode(t.id);if(!l)return this.debugNodeNotFound(t,t.id);const o=this.mirror.getMeta(l);if(l===this.iframe.contentDocument)(r=this.iframe.contentWindow)==null||r.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else if(o?.type===R.Document)(i=l.defaultView)==null||i.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else try{l.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(t){const n=this.mirror.getNode(t.id);if(!n)return this.debugNodeNotFound(t,t.id);try{n.checked=t.isChecked,n.value=t.text}catch{}}applySelection(t){try{const n=new Set,r=t.ranges.map(({start:i,startOffset:l,end:o,endOffset:a})=>{const s=this.mirror.getNode(i),c=this.mirror.getNode(o);if(!s||!c)return;const u=new Range;u.setStart(s,l),u.setEnd(c,a);const p=s.ownerDocument,d=p?.getSelection();return d&&n.add(d),{range:u,selection:d}});n.forEach(i=>i.removeAllRanges()),r.forEach(i=>{var l;return i&&((l=i.selection)==null?void 0:l.addRange(i.range))})}catch{}}applyStyleSheetMutation(t){var n;let r=null;t.styleId?r=this.styleMirror.getStyle(t.styleId):t.id&&(r=((n=this.mirror.getNode(t.id))==null?void 0:n.sheet)||null),r&&(t.source===b.StyleSheetRule?this.applyStyleSheetRule(t,r):t.source===b.StyleDeclaration&&this.applyStyleDeclaration(t,r))}applyStyleSheetRule(t,n){var r,i,l,o;if((r=t.adds)==null||r.forEach(({rule:a,index:s})=>{try{if(Array.isArray(s)){const{positions:c,index:u}=vt(s);ce(n.cssRules,c).insertRule(a,u)}else{const c=s===void 0?void 0:Math.min(s,n.cssRules.length);n?.insertRule(a,c)}}catch{}}),(i=t.removes)==null||i.forEach(({index:a})=>{try{if(Array.isArray(a)){const{positions:s,index:c}=vt(a);ce(n.cssRules,s).deleteRule(c||0)}else n?.deleteRule(a)}catch{}}),t.replace)try{(l=n.replace)==null||l.call(n,t.replace)}catch{}if(t.replaceSync)try{(o=n.replaceSync)==null||o.call(n,t.replaceSync)}catch{}}applyStyleDeclaration(t,n){t.set&&ce(n.rules,t.index).style.setProperty(t.set.property,t.set.value,t.set.priority),t.remove&&ce(n.rules,t.index).style.removeProperty(t.remove.property)}applyAdoptedStyleSheet(t){var n;const r=this.mirror.getNode(t.id);if(!r)return;(n=t.styles)==null||n.forEach(a=>{var s;let c=null,u=null;if(Ee(r)?u=((s=r.ownerDocument)==null?void 0:s.defaultView)||null:r.nodeName==="#document"&&(u=r.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,a.styleId),this.applyStyleSheetRule({source:b.StyleSheetRule,adds:a.rules},c)}catch{}});const i=10;let l=0;const o=(a,s)=>{const c=s.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);Ee(a)?a.shadowRoot.adoptedStyleSheets=c:a.nodeName==="#document"&&(a.adoptedStyleSheets=c),c.length!==s.length&&l<i&&(setTimeout(()=>o(a,s),0+100*l),l++)};o(r,t.styleIds)}legacy_resolveMissingNode(t,n,r,i){const{previousId:l,nextId:o}=i,a=l&&t[l],s=o&&t[o];if(a){const{node:c,mutation:u}=a;n.insertBefore(c,r),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}if(s){const{node:c,mutation:u}=s;n.insertBefore(c,r.nextSibling),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}}moveAndHover(t,n,r,i,l){const o=this.mirror.getNode(r);if(!o)return this.debugNodeNotFound(l,r);const a=yt(o,this.iframe),s=t*a.absoluteScale+a.x,c=n*a.absoluteScale+a.y;this.mouse.style.left=`${s}px`,this.mouse.style.top=`${c}px`,i||this.drawMouseTail({x:s,y:c}),this.hoverElements(o)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:n,lineWidth:r,strokeStyle:i,duration:l}=this.config.mouseTail===!0?_e:Object.assign({},_e,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;const a=this.mouseTail.getContext("2d");!a||!this.tailPositions.length||(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=r,a.lineCap=n,a.strokeStyle=i,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(s=>a.lineTo(s.x,s.y)),a.stroke())};this.tailPositions.push(t),o(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==t),o()},l/this.speedService.state.context.timer.speed)}hoverElements(t){var n;(n=this.lastHoveredRootNode||this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(i=>{i.classList.remove(":hover")}),this.lastHoveredRootNode=t.getRootNode();let r=t;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(t){return t.type!==O.IncrementalSnapshot?!1:t.data.source>b.Mutation&&t.data.source<=b.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(M.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,n){this.warn(`Node with id '${n}' not found. `,t)}warnCanvasMutationFailed(t,n){this.warn("Has error on canvas update",n,"canvas mutation:",t)}debugNodeNotFound(t,n){this.debug(`Node with id '${n}' not found. `,t)}warn(...t){!this.config.showWarning||this.config.logger.warn(bt,...t)}debug(...t){!this.config.showDebug||this.config.logger.log(bt,...t)}}var $=Uint8Array,X=Uint16Array,Le=Uint32Array,Ct=new $([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Rt=new $([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),or=new $([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xt=function(e,t){for(var n=new X(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new Le(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)i[l]=l-n[r]<<5|r;return[n,i]},At=xt(Ct,2),It=At[0],sr=At[1];It[28]=258,sr[258]=28;for(var ar=xt(Rt,0),lr=ar[0],Fe=new X(32768),A=0;A<32768;++A){var Q=(A&43690)>>>1|(A&21845)<<1;Q=(Q&52428)>>>2|(Q&13107)<<2,Q=(Q&61680)>>>4|(Q&3855)<<4,Fe[A]=((Q&65280)>>>8|(Q&255)<<8)>>>1}for(var de=function(e,t,n){for(var r=e.length,i=0,l=new X(t);i<r;++i)++l[e[i]-1];var o=new X(t);for(i=0;i<t;++i)o[i]=o[i-1]+l[i-1]<<1;var a;if(n){a=new X(1<<t);var s=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],p=o[e[i]-1]++<<u,d=p|(1<<u)-1;p<=d;++p)a[Fe[p]>>>s]=c}else for(a=new X(r),i=0;i<r;++i)a[i]=Fe[o[e[i]-1]++]>>>15-e[i];return a},he=new $(288),A=0;A<144;++A)he[A]=8;for(var A=144;A<256;++A)he[A]=9;for(var A=256;A<280;++A)he[A]=7;for(var A=280;A<288;++A)he[A]=8;for(var Ot=new $(32),A=0;A<32;++A)Ot[A]=5;var cr=de(he,9,1),ur=de(Ot,5,1),Pe=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},W=function(e,t,n){var r=t/8>>0;return(e[r]|e[r+1]<<8)>>>(t&7)&n},Ue=function(e,t){var n=t/8>>0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>>(t&7)},dr=function(e){return(e/8>>0)+(e&7&&1)},kt=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e instanceof X?X:e instanceof Le?Le:$)(n-t);return r.set(e.subarray(t,n)),r},hr=function(e,t,n){var r=e.length,i=!t||n,l=!n||n.i;n||(n={}),t||(t=new $(r*3));var o=function(Ft){var Pt=t.length;if(Ft>Pt){var Ut=new $(Math.max(Pt*2,Ft));Ut.set(t),t=Ut}},a=n.f||0,s=n.p||0,c=n.b||0,u=n.l,p=n.d,d=n.m,f=n.n,E=r*8;do{if(!u){n.f=a=W(e,s,1);var g=W(e,s+1,3);if(s+=3,g)if(g==1)u=cr,p=ur,d=9,f=5;else if(g==2){var w=W(e,s,31)+257,T=W(e,s+10,15)+4,C=w+W(e,s+5,31)+1;s+=14;for(var I=new $(C),V=new $(19),F=0;F<T;++F)V[or[F]]=W(e,s+F*3,7);s+=T*3;var Z=Pe(V),pe=(1<<Z)-1;if(!l&&s+C*(Z+7)>E)break;for(var me=de(V,Z,1),F=0;F<C;){var q=me[W(e,s,pe)];s+=q&15;var v=q>>>4;if(v<16)I[F++]=v;else{var j=0,J=0;for(v==16?(J=3+W(e,s,3),s+=2,j=I[F-1]):v==17?(J=3+W(e,s,7),s+=3):v==18&&(J=11+W(e,s,127),s+=7);J--;)I[F++]=j}}var se=I.subarray(0,w),U=I.subarray(w);d=Pe(se),f=Pe(U),u=de(se,d,1),p=de(U,f,1)}else throw"invalid block type";else{var v=dr(s)+4,h=e[v-4]|e[v-3]<<8,N=v+h;if(N>r){if(l)throw"unexpected EOF";break}i&&o(c+h),t.set(e.subarray(v,N),c),n.b=c+=h,n.p=s=N*8;continue}if(s>E)throw"unexpected EOF"}i&&o(c+131072);for(var _=(1<<d)-1,ee=(1<<f)-1,y=d+f+18;l||s+y<E;){var j=u[Ue(e,s)&_],m=j>>>4;if(s+=j&15,s>E)throw"unexpected EOF";if(!j)throw"invalid length/literal";if(m<256)t[c++]=m;else if(m==256){u=null;break}else{var D=m-254;if(m>264){var F=m-257,x=Ct[F];D=W(e,s,(1<<x)-1)+It[F],s+=x}var P=p[Ue(e,s)&ee],K=P>>>4;if(!P)throw"invalid distance";s+=P&15;var U=lr[K];if(K>3){var x=Rt[K];U+=Ue(e,s)&(1<<x)-1,s+=x}if(s>E)throw"unexpected EOF";i&&o(c+131072);for(var Lt=c+D;c<Lt;c+=4)t[c]=t[c-U],t[c+1]=t[c+1-U],t[c+2]=t[c+2-U],t[c+3]=t[c+3-U];c=Lt}}n.l=u,n.p=s,n.b=c,u&&(a=1,n.m=d,n.d=p,n.n=f)}while(!a);return c==t.length?t:kt(t,0,c)},pr=function(e){if((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(e[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function mr(e,t){return hr((pr(e),e.subarray(2,-4)),t)}function fr(e,t){var n=e.length;if(!t&&typeof TextEncoder<"u")return new TextEncoder().encode(e);for(var r=new $(e.length+(e.length>>>1)),i=0,l=function(c){r[i++]=c},o=0;o<n;++o){if(i+5>r.length){var a=new $(i+8+(n-o<<1));a.set(r),r=a}var s=e.charCodeAt(o);s<128||t?l(s):s<2048?(l(192|s>>>6),l(128|s&63)):s>55295&&s<57344?(s=65536+(s&1047552)|e.charCodeAt(++o)&1023,l(240|s>>>18),l(128|s>>>12&63),l(128|s>>>6&63),l(128|s&63)):(l(224|s>>>12),l(128|s>>>6&63),l(128|s&63))}return kt(r,0,i)}function gr(e,t){var n="";if(!t&&typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var r=0;r<e.length;){var i=e[r++];i<128||t?n+=String.fromCharCode(i):i<224?n+=String.fromCharCode((i&31)<<6|e[r++]&63):i<240?n+=String.fromCharCode((i&15)<<12|(e[r++]&63)<<6|e[r++]&63):(i=((i&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,n+=String.fromCharCode(55296|i>>10,56320|i&1023))}return n}const _t="v1",yr=e=>{if(typeof e!="string")return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch{}try{const t=JSON.parse(gr(mr(fr(e,!0))));if(t.v===_t)return t;throw new Error(`These events were packed with packer ${t.v} which is incompatible with current packer ${_t}.`)}catch(t){throw console.error(t),new Error("Unknown data format.")}};return fe.Replayer=ir,fe.unpack=yr,Object.defineProperty(fe,"__esModule",{value:!0}),fe}({});
//# sourceMappingURL=rrweb-replay-unpack.min.js.map
