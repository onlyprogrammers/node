var rrwebReplay=function(ue){"use strict";var C;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(C||(C={}));function yt(e){return e.nodeType===e.ELEMENT_NODE}var Re=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function vt(){return new Re}function Nt(e,t){return!e||!t||e.type!==t.type?!1:e.type===C.Document?e.compatMode===t.compatMode:e.type===C.DocumentType?e.name===t.name&&e.publicId===t.publicId&&e.systemId===t.systemId:e.type===C.Comment||e.type===C.Text||e.type===C.CDATA?e.textContent===t.textContent:e.type===C.Element?e.tagName===t.tagName&&JSON.stringify(e.attributes)===JSON.stringify(t.attributes)&&e.isSVG===t.isSVG&&e.needBlock===t.needBlock:!1}var xe=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function Et(e,t){t===void 0&&(t={});var n=1,r=1;function o(g){var p=g.match(/\n/g);p&&(n+=p.length);var b=g.lastIndexOf(`
`);r=b===-1?r+g.length:g.length-b}function a(){var g={line:n,column:r};return function(p){return p.position=new i(g),T(),p}}var i=function(){function g(p){this.start=p,this.end={line:n,column:r},this.source=t.source}return g}();i.prototype.content=e;var s=[];function l(g){var p=new Error("".concat(t.source||"",":").concat(n,":").concat(r,": ").concat(g));if(p.reason=g,p.filename=t.source,p.line=n,p.column=r,p.source=e,t.silent)s.push(p);else throw p}function c(){var g=h();return{type:"stylesheet",stylesheet:{source:t.source,rules:g,parsingErrors:s}}}function u(){return f(/^{\s*/)}function m(){return f(/^}/)}function h(){var g,p=[];for(T(),y(p);e.length&&e.charAt(0)!=="}"&&(g=_()||ee());)g!==!1&&(p.push(g),y(p));return p}function f(g){var p=g.exec(e);if(p){var b=p[0];return o(b),e=e.slice(b.length),p}}function T(){f(/^\s*/)}function y(g){g===void 0&&(g=[]);for(var p;p=N();)p!==!1&&g.push(p),p=N();return g}function N(){var g=a();if(!(e.charAt(0)!=="/"||e.charAt(1)!=="*")){for(var p=2;e.charAt(p)!==""&&(e.charAt(p)!=="*"||e.charAt(p+1)!=="/");)++p;if(p+=2,e.charAt(p-1)==="")return l("End of comment missing");var b=e.slice(2,p-2);return r+=2,o(b),e=e.slice(p),r+=2,g({type:"comment",comment:b})}}function d(){var g=f(/^([^{]+)/);if(g)return U(g[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(p){return p.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(p){return p.replace(/\u200C/g,",")})}function v(){var g=a(),p=f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(p){var b=U(p[0]);if(!f(/^:\s*/))return l("property missing ':'");var I=f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),P=g({type:"declaration",property:b.replace(xe,""),value:I?U(I[0]).replace(xe,""):""});return f(/^[;\s]*/),P}}function E(){var g=[];if(!u())return l("missing '{'");y(g);for(var p;p=v();)p!==!1&&(g.push(p),y(g)),p=v();return m()?g:l("missing '}'")}function D(){for(var g,p=[],b=a();g=f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)p.push(g[1]),f(/^,\s*/);if(p.length)return b({type:"keyframe",values:p,declarations:E()})}function R(){var g=a(),p=f(/^@([-\w]+)?keyframes\s*/);if(p){var b=p[1];if(p=f(/^([-\w]+)\s*/),!p)return l("@keyframes missing name");var I=p[1];if(!u())return l("@keyframes missing '{'");for(var P,ce=y();P=D();)ce.push(P),ce=ce.concat(y());return m()?g({type:"keyframes",name:I,vendor:b,keyframes:ce}):l("@keyframes missing '}'")}}function k(){var g=a(),p=f(/^@supports *([^{]+)/);if(p){var b=U(p[1]);if(!u())return l("@supports missing '{'");var I=y().concat(h());return m()?g({type:"supports",supports:b,rules:I}):l("@supports missing '}'")}}function V(){var g=a(),p=f(/^@host\s*/);if(p){if(!u())return l("@host missing '{'");var b=y().concat(h());return m()?g({type:"host",rules:b}):l("@host missing '}'")}}function Z(){var g=a(),p=f(/^@media *([^{]+)/);if(p){var b=U(p[1]);if(!u())return l("@media missing '{'");var I=y().concat(h());return m()?g({type:"media",media:b,rules:I}):l("@media missing '}'")}}function De(){var g=a(),p=f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(p)return g({type:"custom-media",name:U(p[1]),media:U(p[2])})}function be(){var g=a(),p=f(/^@page */);if(p){var b=d()||[];if(!u())return l("@page missing '{'");for(var I=y(),P;P=v();)I.push(P),I=I.concat(y());return m()?g({type:"page",selectors:b,declarations:I}):l("@page missing '}'")}}function we(){var g=a(),p=f(/^@([-\w]+)?document *([^{]+)/);if(p){var b=U(p[1]),I=U(p[2]);if(!u())return l("@document missing '{'");var P=y().concat(h());return m()?g({type:"document",document:I,vendor:b,rules:P}):l("@document missing '}'")}}function K(){var g=a(),p=f(/^@font-face\s*/);if(p){if(!u())return l("@font-face missing '{'");for(var b=y(),I;I=v();)b.push(I),b=b.concat(y());return m()?g({type:"font-face",declarations:b}):l("@font-face missing '}'")}}var le=z("import"),Me=z("charset"),Ce=z("namespace");function z(g){var p=new RegExp("^@"+g+"\\s*([^;]+);");return function(){var b=a(),I=f(p);if(I){var P={type:g};return P[g]=I[1].trim(),b(P)}}}function _(){if(e[0]==="@")return R()||Z()||De()||k()||le()||Me()||Ce()||we()||be()||V()||K()}function ee(){var g=a(),p=d();return p?(y(),g({type:"rule",selectors:p,declarations:E()})):l("selector missing")}return de(c())}function U(e){return e?e.replace(/^\s+|\s+$/g,""):""}function de(e,t){for(var n=e&&typeof e.type=="string",r=n?e:t,o=0,a=Object.keys(e);o<a.length;o++){var i=a[o],s=e[i];Array.isArray(s)?s.forEach(function(l){de(l,r)}):s&&typeof s=="object"&&de(s,r)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}var Ae={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Tt(e){var t=Ae[e.tagName]?Ae[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function St(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Ie=/([^\\]):hover/,Dt=new RegExp(Ie.source,"g");function Oe(e,t){var n=t?.stylesWithHoverClass.get(e);if(n)return n;var r=Et(e,{silent:!0});if(!r.stylesheet)return e;var o=[];if(r.stylesheet.rules.forEach(function(s){"selectors"in s&&(s.selectors||[]).forEach(function(l){Ie.test(l)&&o.push(l)})}),o.length===0)return e;var a=new RegExp(o.filter(function(s,l){return o.indexOf(s)===l}).sort(function(s,l){return l.length-s.length}).map(function(s){return St(s)}).join("|"),"g"),i=e.replace(a,function(s){var l=s.replace(Dt,"$1.\\:hover");return"".concat(s,", ").concat(l)});return t?.stylesWithHoverClass.set(e,i),i}function ke(){var e=new Map;return{stylesWithHoverClass:e}}function bt(e,t){var n=t.doc,r=t.hackCss,o=t.cache;switch(e.type){case C.Document:return n.implementation.createDocument(null,"",null);case C.DocumentType:return n.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case C.Element:{var a=Tt(e),i;e.isSVG?i=n.createElementNS("http://www.w3.org/2000/svg",a):i=n.createElement(a);var s={};for(var l in e.attributes)if(Object.prototype.hasOwnProperty.call(e.attributes,l)){var c=e.attributes[l];if(!(a==="option"&&l==="selected"&&c===!1)&&c!==null){if(c===!0&&(c=""),l.startsWith("rr_")){s[l]=c;continue}var u=a==="textarea"&&l==="value",m=a==="style"&&l==="_cssText";if(m&&r&&typeof c=="string"&&(c=Oe(c,o)),(u||m)&&typeof c=="string"){for(var h=n.createTextNode(c),f=0,T=Array.from(i.childNodes);f<T.length;f++){var y=T[f];y.nodeType===i.TEXT_NODE&&i.removeChild(y)}i.appendChild(h);continue}try{if(e.isSVG&&l==="xlink:href")i.setAttributeNS("http://www.w3.org/1999/xlink",l,c.toString());else if(l==="onload"||l==="onclick"||l.substring(0,7)==="onmouse")i.setAttribute("_"+l,c.toString());else if(a==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&l==="content"){i.setAttribute("csp-content",c.toString());continue}else a==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||a==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(a==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?i.setAttribute("rrweb-original-srcset",e.attributes.srcset):i.setAttribute(l,c.toString()))}catch{}}}var N=function(v){var E=s[v];if(a==="canvas"&&v==="rr_dataURL"){var D=document.createElement("img");D.onload=function(){var k=i.getContext("2d");k&&k.drawImage(D,0,0,D.width,D.height)},D.src=E.toString(),i.RRNodeType&&(i.rr_dataURL=E.toString())}else if(a==="img"&&v==="rr_dataURL"){var R=i;R.currentSrc.startsWith("data:")||(R.setAttribute("rrweb-original-src",e.attributes.src),R.src=E.toString())}if(v==="rr_width")i.style.width=E.toString();else if(v==="rr_height")i.style.height=E.toString();else if(v==="rr_mediaCurrentTime"&&typeof E=="number")i.currentTime=E;else if(v==="rr_mediaState")switch(E){case"played":i.play().catch(function(k){return console.warn("media playback error",k)});break;case"paused":i.pause();break}};for(var d in s)N(d);if(e.isShadowHost)if(!i.shadowRoot)i.attachShadow({mode:"open"});else for(;i.shadowRoot.firstChild;)i.shadowRoot.removeChild(i.shadowRoot.firstChild);return i}case C.Text:return n.createTextNode(e.isStyle&&r?Oe(e.textContent,o):e.textContent);case C.CDATA:return n.createCDATASection(e.textContent);case C.Comment:return n.createComment(e.textContent);default:return null}}function X(e,t){var n=t.doc,r=t.mirror,o=t.skipChild,a=o===void 0?!1:o,i=t.hackCss,s=i===void 0?!0:i,l=t.afterAppend,c=t.cache;if(r.has(e.id)){var u=r.getNode(e.id),m=r.getMeta(u);if(Nt(m,e))return r.getNode(e.id)}var h=bt(e,{doc:n,hackCss:s,cache:c});if(!h)return null;if(e.rootId&&r.getNode(e.rootId)!==n&&r.replace(e.rootId,n),e.type===C.Document&&(n.close(),n.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==C.DocumentType&&(e.childNodes[0].type===C.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),h=n),r.add(h,e),(e.type===C.Document||e.type===C.Element)&&!a)for(var f=function(d){var v=X(d,{doc:n,mirror:r,skipChild:!1,hackCss:s,afterAppend:l,cache:c});if(!v)return console.warn("Failed to rebuild",d),"continue";if(d.isShadow&&yt(h)&&h.shadowRoot)h.shadowRoot.appendChild(v);else if(e.type===C.Document&&d.type==C.Element){var E=v,D=null;E.childNodes.forEach(function(R){R.nodeName==="BODY"&&(D=R)}),D?(E.removeChild(D),h.appendChild(v),E.appendChild(D)):h.appendChild(v)}else h.appendChild(v);l&&l(v,d.id)},T=0,y=e.childNodes;T<y.length;T++){var N=y[T];f(N)}return h}function wt(e,t){function n(i){t(i)}for(var r=0,o=e.getIds();r<o.length;r++){var a=o[r];e.has(a)&&n(e.getNode(a))}}function Mt(e,t){var n=t.getMeta(e);if(n?.type===C.Element){var r=e;for(var o in n.attributes)if(Object.prototype.hasOwnProperty.call(n.attributes,o)&&o.startsWith("rr_")){var a=n.attributes[o];o==="rr_scrollLeft"&&(r.scrollLeft=a),o==="rr_scrollTop"&&(r.scrollTop=a)}}}function Ct(e,t){var n=t.doc,r=t.onVisit,o=t.hackCss,a=o===void 0?!0:o,i=t.afterAppend,s=t.cache,l=t.mirror,c=l===void 0?new Re:l,u=X(e,{doc:n,mirror:c,skipChild:!1,hackCss:a,afterAppend:i,cache:s});return wt(c,function(m){r&&r(m),Mt(m,c)}),u}var S;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(S||(S={}));var Rt=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(o){return n.removeNodeFromMap(o)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function xt(){return new Rt}function At(e){const t={},n=/;(?![^(]*\))/g,r=/:(.+)/,o=/\/\*.*?\*\//g;return e.replace(o,"").split(n).forEach(function(a){if(a){const i=a.split(r);i.length>1&&(t[he(i[0].trim())]=i[1].trim())}}),t}function _e(e){const t=[];for(const n in e){const r=e[n];if(typeof r!="string")continue;const o=_t(n);t.push(`${o}: ${r};`)}return t.join(" ")}const It=/-([a-z])/g,Ot=/^--[a-zA-Z0-9-]+$/,he=e=>Ot.test(e)?e:e.replace(It,(t,n)=>n?n.toUpperCase():""),kt=/\B([A-Z])/g,_t=e=>e.replace(kt,"-$1").toLowerCase();class L{constructor(...t){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=A.ELEMENT_NODE,this.TEXT_NODE=A.TEXT_NODE}get childNodes(){const t=[];let n=this.firstChild;for(;n;)t.push(n),n=n.nextSibling;return t}contains(t){if(t instanceof L){if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0}else return!1;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function Lt(e){return class gt extends e{constructor(...n){super(n),this.nodeType=A.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=S.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(n=>n.RRNodeType===S.Element&&n.tagName==="HTML")||null}get body(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===S.Element&&r.tagName==="BODY"))||null}get head(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===S.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(n){const r=n.RRNodeType;if((r===S.Element||r===S.DocumentType)&&this.childNodes.some(a=>a.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const o=pe(this,n);return o.parentElement=null,o}insertBefore(n,r){const o=n.RRNodeType;if((o===S.Element||o===S.DocumentType)&&this.childNodes.some(i=>i.RRNodeType===o))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${o===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const a=$e(this,n,r);return a.parentElement=null,a}removeChild(n){return Ve(this,n)}open(){this.firstChild=null,this.lastChild=null}close(){}write(n){let r;if(n==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":n==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){const o=this.createDocumentType("html",r,"");this.open(),this.appendChild(o)}}createDocument(n,r,o){return new gt}createDocumentType(n,r,o){const a=new(Le(L))(n,r,o);return a.ownerDocument=this,a}createElement(n){const r=new(Pe(L))(n);return r.ownerDocument=this,r}createElementNS(n,r){return this.createElement(r)}createTextNode(n){const r=new(Fe(L))(n);return r.ownerDocument=this,r}createComment(n){const r=new(Be(L))(n);return r.ownerDocument=this,r}createCDATASection(n){const r=new(Ue(L))(n);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}function Le(e){return class extends e{constructor(t,n,r){super(),this.nodeType=A.DOCUMENT_TYPE_NODE,this.RRNodeType=S.DocumentType,this.name=t,this.publicId=n,this.systemId=r,this.nodeName=t,this.textContent=null}toString(){return"RRDocumentType"}}}function Pe(e){return class extends e{constructor(t){super(),this.nodeType=A.ELEMENT_NODE,this.RRNodeType=S.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(n=>t+=n.textContent),t}set textContent(t){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(t))}get classList(){return new Ft(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const t=this.attributes.style?At(this.attributes.style):{},n=/\B([A-Z])/g;return t.setProperty=(r,o,a)=>{if(n.test(r))return;const i=he(r);o?t[i]=o:delete t[i],a==="important"&&(t[i]+=" !important"),this.attributes.style=_e(t)},t.removeProperty=r=>{if(n.test(r))return"";const o=he(r),a=t[o]||"";return delete t[o],this.attributes.style=_e(t),a},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,n){this.attributes[t]=n}setAttributeNS(t,n,r){this.setAttribute(n,r)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return pe(this,t)}insertBefore(t,n){return $e(this,t,n)}removeChild(t){return Ve(this,t)}attachShadow(t){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(t){return!0}toString(){let t="";for(const n in this.attributes)t+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${t}`}}}function Pt(e){return class extends e{attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function Fe(e){return class extends e{constructor(t){super(),this.nodeType=A.TEXT_NODE,this.nodeName="#text",this.RRNodeType=S.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function Be(e){return class extends e{constructor(t){super(),this.nodeType=A.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=S.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function Ue(e){return class extends e{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=A.CDATA_SECTION_NODE,this.RRNodeType=S.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class Ft{constructor(t,n){if(this.classes=[],this.add=(...r)=>{for(const o of r){const a=String(o);this.classes.indexOf(a)>=0||this.classes.push(a)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(o=>r.indexOf(o)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const r=t.trim().split(/\s+/);this.classes.push(...r)}this.onChange=n}}function pe(e,t){return t.parentNode&&t.parentNode.removeChild(t),e.lastChild?(e.lastChild.nextSibling=t,t.previousSibling=e.lastChild):(e.firstChild=t,t.previousSibling=null),e.lastChild=t,t.nextSibling=null,t.parentNode=e,t.parentElement=e,t.ownerDocument=e.ownerDocument,t}function $e(e,t,n){if(!n)return pe(e,t);if(n.parentNode!==e)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return t===n||(t.parentNode&&t.parentNode.removeChild(t),t.previousSibling=n.previousSibling,n.previousSibling=t,t.nextSibling=n,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,t.parentElement=e,t.parentNode=e,t.ownerDocument=e.ownerDocument),t}function Ve(e,t){if(t.parentNode!==e)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return t.previousSibling?t.previousSibling.nextSibling=t.nextSibling:e.firstChild=t.nextSibling,t.nextSibling?t.nextSibling.previousSibling=t.previousSibling:e.lastChild=t.previousSibling,t.previousSibling=null,t.nextSibling=null,t.parentElement=null,t.parentNode=null,t}var A;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(A||(A={}));const me={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},Bt={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};let F=null;function B(e,t,n,r=t.mirror||t.ownerDocument.mirror){e=Ut(e,t,n,r);const o=e.childNodes,a=t.childNodes;(o.length>0||a.length>0)&&We(Array.from(o),a,e,n,r),$t(e,t,n,r)}function Ut(e,t,n,r){var o;if(n.afterAppend&&!F&&(F=new WeakSet,setTimeout(()=>{F=null},0)),!fe(e,t)){const a=te(t,n.mirror,r);(o=e.parentNode)===null||o===void 0||o.replaceChild(a,e),e=a}switch(t.RRNodeType){case S.Document:{if(!W(e,t,n.mirror,r)){const a=r.getMeta(t);a&&(n.mirror.removeNodeFromMap(e),e.close(),e.open(),n.mirror.add(e,a),F?.add(e))}break}case S.Element:{const a=e,i=t;switch(i.tagName){case"IFRAME":{const s=e.contentDocument;if(!s)break;B(s,t.contentDocument,n,r);break}}if(i.shadowRoot){a.shadowRoot||a.attachShadow({mode:"open"});const s=a.shadowRoot.childNodes,l=i.shadowRoot.childNodes;(s.length>0||l.length>0)&&We(Array.from(s),l,a.shadowRoot,n,r)}break}}return e}function $t(e,t,n,r){var o;switch(t.RRNodeType){case S.Document:{const a=t.scrollData;a&&n.applyScroll(a,!0);break}case S.Element:{const a=e,i=t;switch(Vt(a,i,r),i.scrollData&&n.applyScroll(i.scrollData,!0),i.inputData&&n.applyInput(i.inputData),i.tagName){case"AUDIO":case"VIDEO":{const s=e,l=i;l.paused!==void 0&&(l.paused?s.pause():s.play()),l.muted!==void 0&&(s.muted=l.muted),l.volume!==void 0&&(s.volume=l.volume),l.currentTime!==void 0&&(s.currentTime=l.currentTime),l.playbackRate!==void 0&&(s.playbackRate=l.playbackRate);break}case"CANVAS":{const s=t;if(s.rr_dataURL!==null){const l=document.createElement("img");l.onload=()=>{const c=a.getContext("2d");c&&c.drawImage(l,0,0,l.width,l.height)},l.src=s.rr_dataURL}s.canvasMutations.forEach(l=>n.applyCanvas(l.event,l.mutation,e));break}case"STYLE":{const s=a.sheet;s&&t.rules.forEach(l=>n.applyStyleSheetMutation(l,s));break}}break}case S.Text:case S.Comment:case S.CDATA:{e.textContent!==t.data&&(e.textContent=t.data);break}}F!=null&&F.has(e)&&(F.delete(e),(o=n.afterAppend)===null||o===void 0||o.call(n,e,n.mirror.getId(e)))}function Vt(e,t,n){const r=e.attributes,o=t.attributes;for(const a in o){const i=o[a],s=n.getMeta(t);if(s?.isSVG&&me[a])e.setAttributeNS(me[a],a,i);else if(t.tagName==="CANVAS"&&a==="rr_dataURL"){const l=document.createElement("img");l.src=i,l.onload=()=>{const c=e.getContext("2d");c&&c.drawImage(l,0,0,l.width,l.height)}}else e.setAttribute(a,i)}for(const{name:a}of Array.from(r))a in o||e.removeAttribute(a);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}function We(e,t,n,r,o){let a=0,i=e.length-1,s=0,l=t.length-1,c=e[a],u=e[i],m=t[s],h=t[l],f,T;for(;a<=i&&s<=l;)if(c===void 0)c=e[++a];else if(u===void 0)u=e[--i];else if(W(c,m,r.mirror,o))B(c,m,r,o),c=e[++a],m=t[++s];else if(W(u,h,r.mirror,o))B(u,h,r,o),u=e[--i],h=t[--l];else if(W(c,h,r.mirror,o)){try{n.insertBefore(c,u.nextSibling)}catch(y){console.warn(y)}B(c,h,r,o),c=e[++a],h=t[--l]}else if(W(u,m,r.mirror,o)){try{n.insertBefore(u,c)}catch(y){console.warn(y)}B(u,m,r,o),u=e[--i],m=t[++s]}else{if(!f){f={};for(let N=a;N<=i;N++){const d=e[N];d&&r.mirror.hasNode(d)&&(f[r.mirror.getId(d)]=N)}}T=f[o.getId(m)];const y=e[T];if(T!==void 0&&y&&W(y,m,r.mirror,o)){try{n.insertBefore(y,c)}catch(N){console.warn(N)}B(y,m,r,o),e[T]=void 0}else{const N=te(m,r.mirror,o);n.nodeName==="#document"&&c&&(N.nodeType===N.DOCUMENT_TYPE_NODE&&c.nodeType===c.DOCUMENT_TYPE_NODE||N.nodeType===N.ELEMENT_NODE&&c.nodeType===c.ELEMENT_NODE)&&(n.removeChild(c),r.mirror.removeNodeFromMap(c),c=e[++a]);try{n.insertBefore(N,c||null),B(N,m,r,o)}catch(d){console.warn(d)}}m=t[++s]}if(a>i){const y=t[l+1];let N=null;for(y&&(N=r.mirror.getNode(o.getId(y)));s<=l;++s){const d=te(t[s],r.mirror,o);try{n.insertBefore(d,N),B(d,t[s],r,o)}catch(v){console.warn(v)}}}else if(s>l)for(;a<=i;a++){const y=e[a];if(!(!y||y.parentNode!==n))try{n.removeChild(y),r.mirror.removeNodeFromMap(y)}catch(N){console.warn(N)}}}function te(e,t,n){const r=n.getId(e),o=n.getMeta(e);let a=null;if(r>-1&&(a=t.getNode(r)),a!==null&&fe(a,e))return a;switch(e.RRNodeType){case S.Document:a=new Document;break;case S.DocumentType:a=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case S.Element:{let i=e.tagName.toLowerCase();i=Bt[i]||i,o&&"isSVG"in o&&o?.isSVG?a=document.createElementNS(me.svg,i):a=document.createElement(e.tagName);break}case S.Text:a=document.createTextNode(e.data);break;case S.Comment:a=document.createComment(e.data);break;case S.CDATA:a=document.createCDATASection(e.data);break}o&&t.add(a,Object.assign({},o));try{F?.add(a)}catch{}return a}function fe(e,t){return e.nodeType!==t.nodeType?!1:e.nodeType!==e.ELEMENT_NODE||e.tagName.toUpperCase()===t.tagName}function W(e,t,n,r){const o=n.getId(e),a=r.getId(t);return o===-1||o!==a?!1:fe(e,t)}class j extends Lt(L){constructor(t){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=Zt(),this.scrollData=null,t&&(this.mirror=t)}get unserializedId(){return this._unserializedId--}createDocument(t,n,r){return new j}createDocumentType(t,n,r){const o=new Wt(t,n,r);return o.ownerDocument=this,o}createElement(t){const n=t.toUpperCase();let r;switch(n){case"AUDIO":case"VIDEO":r=new jt(n);break;case"IFRAME":r=new Ht(n,this.mirror);break;case"CANVAS":r=new Gt(n);break;case"STYLE":r=new Yt(n);break;default:r=new Q(n);break}return r.ownerDocument=this,r}createComment(t){const n=new Xt(t);return n.ownerDocument=this,n}createCDATASection(t){const n=new Qt(t);return n.ownerDocument=this,n}createTextNode(t){const n=new zt(t);return n.ownerDocument=this,n}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const Wt=Le(L);class Q extends Pe(L){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class jt extends Pt(Q){}class Gt extends Q{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class Yt extends Q{constructor(){super(...arguments),this.rules=[]}}class Ht extends Q{constructor(t,n){super(t),this.contentDocument=new j,this.contentDocument.mirror=n}}const zt=Fe(L),Xt=Be(L),Qt=Ue(L);function qt(e){return e instanceof HTMLFormElement?"FORM":e.tagName.toUpperCase()}function je(e,t,n,r){let o;switch(e.nodeType){case A.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?o=r.contentDocument:(o=t,o.compatMode=e.compatMode);break;case A.DOCUMENT_TYPE_NODE:{const i=e;o=t.createDocumentType(i.name,i.publicId,i.systemId);break}case A.ELEMENT_NODE:{const i=e,s=qt(i);o=t.createElement(s);const l=o;for(const{name:c,value:u}of Array.from(i.attributes))l.attributes[c]=u;i.scrollLeft&&(l.scrollLeft=i.scrollLeft),i.scrollTop&&(l.scrollTop=i.scrollTop);break}case A.TEXT_NODE:o=t.createTextNode(e.textContent||"");break;case A.CDATA_SECTION_NODE:o=t.createCDATASection(e.data);break;case A.COMMENT_NODE:o=t.createComment(e.textContent||"");break;case A.DOCUMENT_FRAGMENT_NODE:o=r.attachShadow({mode:"open"});break;default:return null}let a=n.getMeta(e);return t instanceof j&&(a||(a=Ge(o,t.unserializedId),n.add(e,a)),t.mirror.add(o,Object.assign({},a))),o}function Jt(e,t=xt(),n=new j){function r(o,a){const i=je(o,n,t,a);if(i!==null)if(a?.nodeName!=="IFRAME"&&o.nodeType!==A.DOCUMENT_FRAGMENT_NODE&&(a?.appendChild(i),i.parentNode=a,i.parentElement=a),o.nodeName==="IFRAME"){const s=o.contentDocument;s&&r(s,i)}else(o.nodeType===A.DOCUMENT_NODE||o.nodeType===A.ELEMENT_NODE||o.nodeType===A.DOCUMENT_FRAGMENT_NODE)&&(o.nodeType===A.ELEMENT_NODE&&o.shadowRoot&&r(o.shadowRoot,i),o.childNodes.forEach(s=>r(s,i)))}return r(e,null),n}function Zt(){return new Kt}class Kt{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){const r=this.getNode(t);if(r){const o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Ge(e,t){switch(e.RRNodeType){case S.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case S.DocumentType:{const n=e;return{id:t,type:e.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case S.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case S.Text:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function Ye(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(o){o(n)}),(r=e.get("*"))&&r.slice().map(function(o){o(t,n)})}}}var en=Object.freeze({__proto__:null,default:Ye});function tn(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const n=e.HTMLElement||e.Element,r=468,o={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||l,scrollIntoView:n.prototype.scrollIntoView},a=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;function i(d){const v=["MSIE ","Trident/","Edge/"];return new RegExp(v.join("|")).test(d)}const s=i(e.navigator.userAgent)?1:0;function l(d,v){this.scrollLeft=d,this.scrollTop=v}function c(d){return .5*(1-Math.cos(Math.PI*d))}function u(d){if(d===null||typeof d!="object"||d.behavior===void 0||d.behavior==="auto"||d.behavior==="instant")return!0;if(typeof d=="object"&&d.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+d.behavior+" is not a valid value for enumeration ScrollBehavior.")}function m(d,v){if(v==="Y")return d.clientHeight+s<d.scrollHeight;if(v==="X")return d.clientWidth+s<d.scrollWidth}function h(d,v){const E=e.getComputedStyle(d,null)["overflow"+v];return E==="auto"||E==="scroll"}function f(d){const v=m(d,"Y")&&h(d,"Y"),E=m(d,"X")&&h(d,"X");return v||E}function T(d){for(;d!==t.body&&f(d)===!1;)d=d.parentNode||d.host;return d}function y(d){const v=a();let E,D,R,k=(v-d.startTime)/r;k=k>1?1:k,E=c(k),D=d.startX+(d.x-d.startX)*E,R=d.startY+(d.y-d.startY)*E,d.method.call(d.scrollable,D,R),(D!==d.x||R!==d.y)&&e.requestAnimationFrame(y.bind(e,d))}function N(d,v,E){let D,R,k,V;const Z=a();d===t.body?(D=e,R=e.scrollX||e.pageXOffset,k=e.scrollY||e.pageYOffset,V=o.scroll):(D=d,R=d.scrollLeft,k=d.scrollTop,V=l),y({scrollable:D,method:V,startTime:Z,startX:R,startY:k,x:v,y:E})}e.scroll=e.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){o.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset);return}N.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset)}},e.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){o.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}N.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const d=arguments[0].left,v=arguments[0].top;N.call(this,this,typeof d>"u"?this.scrollLeft:~~d,typeof v>"u"?this.scrollTop:~~v)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){o.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const d=T(this),v=d.getBoundingClientRect(),E=this.getBoundingClientRect();d!==t.body?(N.call(this,d,d.scrollLeft+E.left-v.left,d.scrollTop+E.top-v.top),e.getComputedStyle(d).position!=="fixed"&&e.scrollBy({left:v.left,top:v.top,behavior:"smooth"})):e.scrollBy({left:E.left,top:E.top,behavior:"smooth"})}}var x=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(x||{}),w=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(w||{}),O=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(O||{}),ne=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(ne||{}),re=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(re||{}),M=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(M||{});class nn{constructor(t=[],n){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=n.speed}addAction(t){const n=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=t.delay)this.actions.push(t);else{const r=this.findActionIndex(t);this.actions.splice(r,0,t)}n&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){const t=performance.now();for(this.timeOffset+=(t-this.lastTimestamp)*this.speed,this.lastTimestamp=t;this.actions.length;){const n=this.actions[0];if(this.timeOffset>=n.delay)this.actions.shift(),n.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}isActive(){return this.raf!==null}findActionIndex(t){let n=0,r=this.actions.length-1;for(;n<=r;){const o=Math.floor((n+r)/2);if(this.actions[o].delay<t.delay)n=o+1;else if(this.actions[o].delay>t.delay)r=o-1;else return o+1}return n}}function He(e,t){if(e.type===x.IncrementalSnapshot&&e.data.source===w.MouseMove&&e.data.positions&&e.data.positions.length){const n=e.data.positions[0].timeOffset,r=e.timestamp+n;return e.delay=r-t,r-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function ze(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}var G;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(G||(G={}));var Xe={type:"xstate.init"};function ge(e){return e===void 0?[]:[].concat(e)}function Y(e){return{type:"xstate.assign",assignment:e}}function Qe(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function ie(e){return function(t){return e===t}}function qe(e){return typeof e=="string"?{type:e}:e}function Je(e,t){return{value:e,context:t,actions:[],changed:!1,matches:ie(e)}}function Ze(e,t,n){var r=t,o=!1;return[e.filter(function(a){if(a.type==="xstate.assign"){o=!0;var i=Object.assign({},r);return typeof a.assignment=="function"?i=a.assignment(r,n):Object.keys(a.assignment).forEach(function(s){i[s]=typeof a.assignment[s]=="function"?a.assignment[s](r,n):a.assignment[s]}),r=i,!1}return!0}),r,o]}function Ke(e,t){t===void 0&&(t={});var n=ze(Ze(ge(e.states[e.initial].entry).map(function(i){return Qe(i,t.actions)}),e.context,Xe),2),r=n[0],o=n[1],a={config:e,_options:t,initialState:{value:e.initial,actions:r,context:o,matches:ie(e.initial)},transition:function(i,s){var l,c,u=typeof i=="string"?{value:i,context:e.context}:i,m=u.value,h=u.context,f=qe(s),T=e.states[m];if(T.on){var y=ge(T.on[f.type]);try{for(var N=function(_){var ee=typeof Symbol=="function"&&Symbol.iterator,g=ee&&_[ee],p=0;if(g)return g.call(_);if(_&&typeof _.length=="number")return{next:function(){return _&&p>=_.length&&(_=void 0),{value:_&&_[p++],done:!_}}};throw new TypeError(ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(y),d=N.next();!d.done;d=N.next()){var v=d.value;if(v===void 0)return Je(m,h);var E=typeof v=="string"?{target:v}:v,D=E.target,R=E.actions,k=R===void 0?[]:R,V=E.cond,Z=V===void 0?function(){return!0}:V,De=D===void 0,be=D??m,we=e.states[be];if(Z(h,f)){var K=ze(Ze((De?ge(k):[].concat(T.exit,k,we.entry).filter(function(_){return _})).map(function(_){return Qe(_,a._options.actions)}),h,f),3),le=K[0],Me=K[1],Ce=K[2],z=D??m;return{value:z,context:Me,actions:le,changed:D!==m||le.length>0||Ce,matches:ie(z)}}}}catch(_){l={error:_}}finally{try{d&&!d.done&&(c=N.return)&&c.call(N)}finally{if(l)throw l.error}}}return Je(m,h)}};return a}var et=function(e,t){return e.actions.forEach(function(n){var r=n.exec;return r&&r(e.context,t)})};function tt(e){var t=e.initialState,n=G.NotStarted,r=new Set,o={_machine:e,send:function(a){n===G.Running&&(t=e.transition(t,a),et(t,qe(a)),r.forEach(function(i){return i(t)}))},subscribe:function(a){return r.add(a),a(t),{unsubscribe:function(){return r.delete(a)}}},start:function(a){if(a){var i=typeof a=="object"?a:{context:e.config.context,value:a};t={value:i.value,actions:[],context:i.context,matches:ie(i.value)}}return n=G.Running,et(t,Xe),o},stop:function(){return n=G.Stopped,r.clear(),o},get state(){return t},get status(){return n}};return o}var rn=Object.defineProperty,on=Object.defineProperties,sn=Object.getOwnPropertyDescriptors,nt=Object.getOwnPropertySymbols,an=Object.prototype.hasOwnProperty,ln=Object.prototype.propertyIsEnumerable,rt=(e,t,n)=>t in e?rn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ye=(e,t)=>{for(var n in t||(t={}))an.call(t,n)&&rt(e,n,t[n]);if(nt)for(var n of nt(t))ln.call(t,n)&&rt(e,n,t[n]);return e},ve=(e,t)=>on(e,sn(t));function cn(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.type===x.Meta&&r.timestamp<=t)return e.slice(n)}return e}function un(e,{getCastFn:t,applyEventsSynchronously:n,emitter:r}){const o=Ke({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Y({lastPlayedEvent:(a,i)=>i.type==="CAST_EVENT"?i.payload.event:a.lastPlayedEvent}),recordTimeOffset:Y((a,i)=>{let s=a.timeOffset;return"payload"in i&&"timeOffset"in i.payload&&(s=i.payload.timeOffset),ve(ye({},a),{timeOffset:s,baselineTime:a.events[0].timestamp+s})}),play(a){var i;const{timer:s,events:l,baselineTime:c,lastPlayedEvent:u}=a;s.clear();for(const T of l)He(T,c);const m=cn(l,c);let h=u?.timestamp;u?.type===x.IncrementalSnapshot&&u.data.source===w.MouseMove&&(h=u.timestamp+((i=u.data.positions[0])==null?void 0:i.timeOffset)),c<(h||0)&&r.emit(M.PlayBack);const f=new Array;for(const T of m)if(!(h&&h<c&&(T.timestamp<=h||T===u)))if(T.timestamp<c)f.push(T);else{const y=t(T,!1);s.addAction({doAction:()=>{y()},delay:T.delay})}n(f),r.emit(M.Flush),s.start()},pause(a){a.timer.clear()},resetLastPlayedEvent:Y(a=>ve(ye({},a),{lastPlayedEvent:null})),startLive:Y({baselineTime:(a,i)=>(a.timer.start(),i.type==="TO_LIVE"&&i.payload.baselineTime?i.payload.baselineTime:Date.now())}),addEvent:Y((a,i)=>{const{baselineTime:s,timer:l,events:c}=a;if(i.type==="ADD_EVENT"){const{event:u}=i.payload;He(u,s);let m=c.length-1;if(!c[m]||c[m].timestamp<=u.timestamp)c.push(u);else{let T=-1,y=0;for(;y<=m;){const N=Math.floor((y+m)/2);c[N].timestamp<=u.timestamp?y=N+1:m=N-1}T===-1&&(T=y),c.splice(T,0,u)}const h=u.timestamp<s,f=t(u,h);h?f():l.isActive()&&l.addAction({doAction:()=>{f()},delay:u.delay})}return ve(ye({},a),{events:c})})}});return tt(o)}function dn(e){const t=Ke({id:"speed",context:e,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(n,r)=>{"payload"in r&&n.timer.setSpeed(r.payload.speed)},recordSpeed:Y({normalSpeed:n=>n.timer.speed}),restoreSpeed:n=>{n.timer.setSpeed(n.normalSpeed)}}});return tt(t)}const H=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let it={map:{},getId(){return console.error(H),-1},getNode(){return console.error(H),null},removeNodeFromMap(){console.error(H)},has(){return console.error(H),!1},reset(){console.error(H)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(it=new Proxy(it,{get(e,t,n){return t==="map"&&console.error(H),Reflect.get(e,t,n)}}));function hn(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function pn(e){const t={},n=(o,a)=>{const i={value:o,parent:a,children:[]};return t[o.node.id]=i,i},r=[];for(const o of e){const{nextId:a,parentId:i}=o;if(a&&a in t){const s=t[a];if(s.parent){const l=s.parent.children.indexOf(s);s.parent.children.splice(l,0,n(o,s.parent))}else{const l=r.indexOf(s);r.splice(l,0,n(o,null))}continue}if(i in t){const s=t[i];s.children.push(n(o,s));continue}r.push(n(o,null))}return r}function ot(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)ot(e.children[n],t)}function Ne(e,t){return Boolean(e.nodeName==="IFRAME"&&t.getMeta(e))}function st(e,t){var n,r;const o=(r=(n=e.ownerDocument)==null?void 0:n.defaultView)==null?void 0:r.frameElement;if(!o||o===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const a=o.getBoundingClientRect(),i=st(o,t),s=a.height/o.clientHeight;return{x:a.x*i.relativeScale+i.x,y:a.y*i.relativeScale+i.y,relativeScale:s,absoluteScale:i.absoluteScale*s}}function oe(e){return Boolean(e?.shadowRoot)}function q(e,t){const n=e[t[0]];return t.length===1?n:q(n.cssRules[t[1]].cssRules,t.slice(2))}function at(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function mn(e){const t=new Set,n=[];for(let r=e.length;r--;){const o=e[r];t.has(o.id)||(n.push(o),t.add(o.id))}return n}class fn{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var n;return(n=this.styleIDMap.get(t))!=null?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}const gn=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"];for(var lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J=typeof Uint8Array>"u"?[]:new Uint8Array(256),se=0;se<lt.length;se++)J[lt.charCodeAt(se)]=se;var yn=function(e){var t=e.length*.75,n=e.length,r,o=0,a,i,s,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var c=new ArrayBuffer(t),u=new Uint8Array(c);for(r=0;r<n;r+=4)a=J[e.charCodeAt(r)],i=J[e.charCodeAt(r+1)],s=J[e.charCodeAt(r+2)],l=J[e.charCodeAt(r+3)],u[o++]=a<<2|i>>4,u[o++]=(i&15)<<4|s>>2,u[o++]=(s&3)<<6|l&63;return c},vn=(e,t,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(e,t)).next())});const ct=new Map;function ut(e,t){let n=ct.get(e);return n||(n=new Map,ct.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}function $(e,t,n){return r=>vn(this,null,function*(){if(r&&typeof r=="object"&&"rr_type"in r)if(n&&(n.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){const o=yield $(e,t,n)(r.args);return yield createImageBitmap.apply(null,o)}else if("index"in r){if(n||t===null)return r;const{rr_type:o,index:a}=r;return ut(t,o)[a]}else if("args"in r){const{rr_type:o,args:a}=r,i=window[o];return new i(...yield Promise.all(a.map($(e,t,n))))}else{if("base64"in r)return yn(r.base64);if("src"in r){const o=e.get(r.src);if(o)return o;{const a=new Image;return a.src=r.src,e.set(r.src,a),a}}else if("data"in r&&r.rr_type==="Blob"){const o=yield Promise.all(r.data.map($(e,t,n)));return new Blob(o,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map($(e,t,n)));return r})}var Nn=(e,t,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(e,t)).next())});function En(e,t){try{return t===ne.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}const Tn=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Sn(e,t){if(!(t!=null&&t.constructor))return;const{name:n}=t.constructor;if(!Tn.includes(n))return;const r=ut(e,n);r.includes(t)||r.push(t)}function Dn(e){return Nn(this,arguments,function*({mutation:t,target:n,type:r,imageMap:o,errorHandler:a}){try{const i=En(n,r);if(!i)return;if(t.setter){i[t.property]=t.args[0];return}const s=i[t.property],l=yield Promise.all(t.args.map($(o,i))),c=s.apply(i,l);Sn(i,c)}catch(i){a(t,i)}})}var bn=(e,t,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(e,t)).next())});function wn(e){return bn(this,arguments,function*({event:t,mutation:n,target:r,imageMap:o,errorHandler:a}){try{const i=r.getContext("2d");if(n.setter){i[n.property]=n.args[0];return}const s=i[n.property];if(n.property==="drawImage"&&typeof n.args[0]=="string")o.get(t),s.apply(i,n.args);else{const l=yield Promise.all(n.args.map($(o,i)));s.apply(i,l)}}catch(i){a(n,i)}})}var Mn=(e,t,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(e,t)).next())});function dt(e){return Mn(this,arguments,function*({event:t,mutation:n,target:r,imageMap:o,canvasEventMap:a,errorHandler:i}){try{const s=a.get(t)||n,l="commands"in s?s.commands:[s];if([ne.WebGL,ne.WebGL2].includes(n.type)){for(let c=0;c<l.length;c++){const u=l[c];yield Dn({mutation:u,type:n.type,target:r,imageMap:o,errorHandler:i})}return}for(let c=0;c<l.length;c++){const u=l[c];yield wn({event:t,mutation:u,target:r,imageMap:o,errorHandler:i})}}catch(s){i(n,s)}})}var Cn=Object.defineProperty,Rn=Object.defineProperties,xn=Object.getOwnPropertyDescriptors,ht=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,In=Object.prototype.propertyIsEnumerable,pt=(e,t,n)=>t in e?Cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ae=(e,t)=>{for(var n in t||(t={}))An.call(t,n)&&pt(e,n,t[n]);if(ht)for(var n of ht(t))In.call(t,n)&&pt(e,n,t[n]);return e},Ee=(e,t)=>Rn(e,xn(t)),Te=(e,t,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(e,t)).next())});const On=10*1e3,kn=5*1e3,_n=Ye||en,mt="[replayer]",Se={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function ft(e){return e.type==x.IncrementalSnapshot&&(e.data.source==w.TouchMove||e.data.source==w.MouseInteraction&&e.data.type==O.TouchStart)}class Ln{constructor(t,n){if(this.usingVirtualDom=!1,this.virtualDom=new j,this.mouseTail=null,this.tailPositions=[],this.emitter=_n(),this.legacy_missingNodeRetryMap={},this.cache=ke(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=vt(),this.styleMirror=new fn,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=s=>{this.iframe.style.display="inherit";for(const l of[this.mouseTail,this.iframe])!l||(l.setAttribute("width",String(s.width)),l.setAttribute("height",String(s.height)))},this.applyEventsSynchronously=s=>{for(const l of s){switch(l.type){case x.DomContentLoaded:case x.Load:case x.Custom:continue;case x.FullSnapshot:case x.Meta:case x.Plugin:case x.IncrementalSnapshot:break}this.getCastFn(l,!0)()}},this.getCastFn=(s,l=!1)=>{let c;switch(s.type){case x.DomContentLoaded:case x.Load:break;case x.Custom:c=()=>{this.emitter.emit(M.CustomEvent,s)};break;case x.Meta:c=()=>this.emitter.emit(M.Resize,{width:s.data.width,height:s.data.height});break;case x.FullSnapshot:c=()=>{var u;if(this.firstFullSnapshot){if(this.firstFullSnapshot===s){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(s,l),(u=this.iframe.contentWindow)==null||u.scrollTo(s.data.initialOffset),this.styleMirror.reset()};break;case x.IncrementalSnapshot:c=()=>{if(this.applyIncremental(s,l),!l&&(s===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const u of this.service.state.context.events)if(!(u.timestamp<=s.timestamp)&&this.isUserInteraction(u)){u.delay-s.delay>On*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){const u=this.nextUserInteractionEvent.delay-s.delay,m={speed:Math.min(Math.round(u/kn),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:m}),this.emitter.emit(M.SkipStart,m)}}};break}return()=>{c&&c();for(const m of this.config.plugins||[])m.handler&&m.handler(s,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:s}});const u=this.service.state.context.events.length-1;if(!this.config.liveMode&&s===this.service.state.context.events[u]){const m=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(M.Finish))};let h=50;s.type===x.IncrementalSnapshot&&s.data.source===w.MouseMove&&s.data.positions.length&&(h+=Math.max(0,-s.data.positions[0].timeOffset)),setTimeout(m,h)}this.emitter.emit(M.EventCast,s)}},!(n!=null&&n.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Se,useVirtualDom:!0,logger:console};this.config=Object.assign({},r,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(M.Resize,this.handleResize),this.setupDom();for(const s of this.config.plugins||[])s.getMirror&&s.getMirror({nodeMirror:this.mirror});this.emitter.on(M.Flush,()=>{if(this.usingVirtualDom){const s={mirror:this.mirror,applyCanvas:(l,c,u)=>{dt({event:l,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,c)=>{l.source===w.StyleSheetRule?this.applyStyleSheetRule(l,c):l.source===w.StyleDeclaration&&this.applyStyleDeclaration(l,c)},afterAppend:(l,c)=>{for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(l,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{B(this.iframe.contentDocument,this.virtualDom,s,this.virtualDom.mirror)}catch(l){console.warn(l)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const l in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[l],u=te(c.node,this.mirror,this.virtualDom.mirror);B(u,c.node,s,this.virtualDom.mirror),c.node=u}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){const[s,l]=this.lastMouseDownEvent;s.dispatchEvent(l)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(M.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});const o=new nn([],{speed:this.config.speed});this.service=un({events:t.map(s=>n&&n.unpackFn?n.unpackFn(s):s).sort((s,l)=>s.timestamp-l.timestamp),timer:o,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(s=>{this.emitter.emit(M.StateChange,{player:s})}),this.speedService=dn({normalSpeed:-1,timer:o}),this.speedService.start(),this.speedService.subscribe(s=>{this.emitter.emit(M.StateChange,{speed:s})});const a=this.service.state.context.events.find(s=>s.type===x.Meta),i=this.service.state.context.events.find(s=>s.type===x.FullSnapshot);if(a){const{width:s,height:l}=a.data;setTimeout(()=>{this.emitter.emit(M.Resize,{width:s,height:l})},0)}i&&setTimeout(()=>{var s;this.firstFullSnapshot||(this.firstFullSnapshot=i,this.rebuildFullSnapshot(i),(s=this.iframe.contentWindow)==null||s.scrollTo(i.data.initialOffset))},1),this.service.state.context.events.find(ft)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(t,n){return this.emitter.on(t,n),this}off(t,n){return this.emitter.off(t,n),this}setConfig(t){Object.keys(t).forEach(n=>{t[n],this.config[n]=t[n]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:n.timestamp,totalTime:n.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:n}=this.service.state.context;return t-n[0].timestamp}getMirror(){return this.mirror}play(t=0){var n,r;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:t}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.remove("rrweb-paused"),this.emitter.emit(M.Start)}pause(t){var n,r;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.add("rrweb-paused"),this.emitter.emit(M.Pause)}resume(t=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(M.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(M.Destroy)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const n=this.config.unpackFn?this.config.unpackFn(t):t;ft(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=ke()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(tn(this.iframe.contentWindow,this.iframe.contentDocument),hn(this.iframe.contentWindow))}rebuildFullSnapshot(t,n=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[],o=(s,l)=>{this.collectIframeAndAttachDocument(r,s);for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(s,{id:l,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),Ct(t.data.node,{doc:this.iframe.contentDocument,afterAppend:o,cache:this.cache,mirror:this.mirror}),o(this.iframe.contentDocument,t.data.node.id);for(const{mutationInQueue:s,builtNode:l}of r)this.attachDocumentToIframe(s,l),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==s);const{documentElement:a,head:i}=this.iframe.contentDocument;this.insertStyleRules(a,i),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(M.FullsnapshotRebuilded,t),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,n){var r;const o=gn(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&o.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const a=this.virtualDom.createElement("style");this.virtualDom.mirror.add(a,Ge(a,this.virtualDom.unserializedId)),t.insertBefore(a,n),a.rules.push({source:w.StyleSheetRule,adds:o.map((i,s)=>({rule:i,index:s}))})}else{const a=document.createElement("style");t.insertBefore(a,n);for(let i=0;i<o.length;i++)(r=a.sheet)==null||r.insertRule(o[i],i)}}attachDocumentToIframe(t,n){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,o=[],a=(i,s)=>{this.collectIframeAndAttachDocument(o,i);const l=r.getMeta(i);if(l?.type===C.Element&&l?.tagName.toUpperCase()==="HTML"){const{documentElement:c,head:u}=n.contentDocument;this.insertStyleRules(c,u)}if(!this.usingVirtualDom)for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(i,{id:s,replayer:this})};X(t.node,{doc:n.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:a,cache:this.cache}),a(n.contentDocument,t.node.id);for(const{mutationInQueue:i,builtNode:s}of o)this.attachDocumentToIframe(i,s),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==i)}collectIframeAndAttachDocument(t,n){if(Ne(n,this.mirror)){const r=this.newDocumentQueue.find(o=>o.parentId===this.mirror.getId(n));r&&t.push({mutationInQueue:r,builtNode:n})}}waitForStylesheetLoad(){var t;const n=(t=this.iframe.contentDocument)==null?void 0:t.head;if(n){const r=new Set;let o,a=this.service.state;const i=()=>{a=this.service.state};this.emitter.on(M.Start,i),this.emitter.on(M.Pause,i);const s=()=>{this.emitter.off(M.Start,i),this.emitter.off(M.Pause,i)};n.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(r.add(l),l.addEventListener("load",()=>{r.delete(l),r.size===0&&o!==-1&&(a.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(M.LoadStylesheetEnd),o&&clearTimeout(o),s())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(M.LoadStylesheetStart),o=setTimeout(()=>{a.matches("playing")&&this.play(this.getCurrentTime()),o=-1,s()},this.config.loadTimeout))}}preloadAllImages(){return Te(this,null,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(M.Start,t),this.emitter.on(M.Pause,t);const n=[];for(const r of this.service.state.context.events)r.type===x.IncrementalSnapshot&&r.data.source===w.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(o=>{this.preloadImages(o,r)}));return Promise.all(n)})}preloadImages(t,n){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(n)){const r=document.createElement("canvas"),o=r.getContext("2d"),a=o?.createImageData(r.width,r.height);a?.data,JSON.parse(t.args[0]),o?.putImageData(a,0,0)}}deserializeAndPreloadCanvasEvents(t,n){return Te(this,null,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};if("commands"in t){const o=yield Promise.all(t.commands.map(a=>Te(this,null,function*(){const i=yield Promise.all(a.args.map($(this.imageMap,null,r)));return Ee(ae({},a),{args:i})})));r.isUnchanged===!1&&this.canvasEventMap.set(n,Ee(ae({},t),{commands:o}))}else{const o=yield Promise.all(t.args.map($(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(n,Ee(ae({},t),{args:o}))}}})}applyIncremental(t,n){var r,o,a;const{data:i}=t;switch(i.source){case w.Mutation:{try{this.applyMutation(i,n)}catch(s){this.warn(`Exception in mutation ${s.message||s}`,i)}break}case w.Drag:case w.TouchMove:case w.MouseMove:if(n){const s=i.positions[i.positions.length-1];this.mousePos={x:s.x,y:s.y,id:s.id,debugData:i}}else i.positions.forEach(s=>{const l={doAction:()=>{this.moveAndHover(s.x,s.y,s.id,n,i)},delay:s.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:t.delay-((r=i.positions[0])==null?void 0:r.timeOffset)});break;case w.MouseInteraction:{if(i.id===-1)break;const s=new Event(O[i.type].toLowerCase()),l=this.mirror.getNode(i.id);if(!l)return this.debugNodeNotFound(i,i.id);this.emitter.emit(M.MouseInteraction,{type:i.type,target:l});const{triggerFocus:c}=this.config;switch(i.type){case O.Blur:"blur"in l&&l.blur();break;case O.Focus:c&&l.focus&&l.focus({preventScroll:!0});break;case O.Click:case O.TouchStart:case O.TouchEnd:case O.MouseDown:case O.MouseUp:n?(i.type===O.TouchStart?this.touchActive=!0:i.type===O.TouchEnd&&(this.touchActive=!1),i.type===O.MouseDown?this.lastMouseDownEvent=[l,s]:i.type===O.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:i.x,y:i.y,id:i.id,debugData:i}):(i.type===O.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(i.x,i.y,i.id,n,i),i.type===O.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):i.type===O.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):i.type===O.TouchEnd?this.mouse.classList.remove("touch-active"):l.dispatchEvent(s));break;case O.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(s)}break}case w.Scroll:{if(i.id===-1)break;if(this.usingVirtualDom){const s=this.virtualDom.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);s.scrollData=i;break}this.applyScroll(i,n);break}case w.ViewportResize:this.emitter.emit(M.Resize,{width:i.width,height:i.height});break;case w.Input:{if(i.id===-1)break;if(this.usingVirtualDom){const s=this.virtualDom.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);s.inputData=i;break}this.applyInput(i);break}case w.MediaInteraction:{const s=this.usingVirtualDom?this.virtualDom.mirror.getNode(i.id):this.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);const l=s;try{i.currentTime!==void 0&&(l.currentTime=i.currentTime),i.volume!==void 0&&(l.volume=i.volume),i.muted!==void 0&&(l.muted=i.muted),i.type===re.Pause&&l.pause(),i.type===re.Play&&l.play(),i.type===re.RateChange&&(l.playbackRate=i.playbackRate)}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case w.StyleSheetRule:case w.StyleDeclaration:{this.usingVirtualDom?i.styleId?this.constructedStyleMutations.push(i):i.id&&((o=this.virtualDom.mirror.getNode(i.id))==null||o.rules.push(i)):this.applyStyleSheetMutation(i);break}case w.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const s=this.virtualDom.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);s.canvasMutations.push({event:t,mutation:i})}else{const s=this.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);dt({event:t,mutation:i,target:s,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case w.Font:{try{const s=new FontFace(i.family,i.buffer?new Uint8Array(JSON.parse(i.fontSource)):i.fontSource,i.descriptors);(a=this.iframe.contentDocument)==null||a.fonts.add(s)}catch(s){this.warn(s)}break}case w.Selection:{if(n){this.lastSelectionData=i;break}this.applySelection(i);break}case w.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(i):this.applyAdoptedStyleSheet(i);break}}}applyMutation(t,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,Jt(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const c in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[c],m=je(u.node,this.virtualDom,this.mirror);m&&(u.node=m)}catch(u){this.warn(u)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes=t.removes.filter(c=>r.getNode(c.id)?!0:(this.warnNodeNotFound(t,c.id),!1)),t.removes.forEach(c=>{var u;const m=r.getNode(c.id);if(!m)return;let h=r.getNode(c.parentId);if(!h)return this.warnNodeNotFound(t,c.parentId);if(c.isShadow&&oe(h)&&(h=h.shadowRoot),r.removeNodeFromMap(m),h)try{h.removeChild(m),this.usingVirtualDom&&m.nodeName==="#text"&&h.nodeName==="STYLE"&&((u=h.rules)==null?void 0:u.length)>0&&(h.rules=[])}catch(f){if(f instanceof DOMException)this.warn("parent could not remove child in mutation",h,m,t);else throw f}});const o=ae({},this.legacy_missingNodeRetryMap),a=[],i=c=>{let u=null;return c.nextId&&(u=r.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},s=c=>{var u,m;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let h=r.getNode(c.parentId);if(!h)return c.node.type===C.Document?this.newDocumentQueue.push(c):a.push(c);c.node.isShadow&&(oe(h)||h.attachShadow({mode:"open"}),h=h.shadowRoot);let f=null,T=null;if(c.previousId&&(f=r.getNode(c.previousId)),c.nextId&&(T=r.getNode(c.nextId)),i(c))return a.push(c);if(c.node.rootId&&!r.getNode(c.node.rootId))return;const y=c.node.rootId?r.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Ne(h,r)){this.attachDocumentToIframe(c,h);return}const N=(E,D)=>{if(!this.usingVirtualDom)for(const R of this.config.plugins||[])R.onBuild&&R.onBuild(E,{id:D,replayer:this})},d=X(c.node,{doc:y,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:N});if(c.previousId===-1||c.nextId===-1){o[c.node.id]={node:d,mutation:c};return}const v=r.getMeta(h);if(v&&v.type===C.Element&&v.tagName==="textarea"&&c.node.type===C.Text){const E=Array.isArray(h.childNodes)?h.childNodes:Array.from(h.childNodes);for(const D of E)D.nodeType===h.TEXT_NODE&&h.removeChild(D)}else if(v?.type===C.Document){const E=h;c.node.type===C.DocumentType&&((u=E.childNodes[0])==null?void 0:u.nodeType)===Node.DOCUMENT_TYPE_NODE&&E.removeChild(E.childNodes[0]),d.nodeName==="HTML"&&E.documentElement&&E.removeChild(E.documentElement)}if(f&&f.nextSibling&&f.nextSibling.parentNode?h.insertBefore(d,f.nextSibling):T&&T.parentNode?h.contains(T)?h.insertBefore(d,T):h.insertBefore(d,null):h.appendChild(d),N(d,c.node.id),this.usingVirtualDom&&d.nodeName==="#text"&&h.nodeName==="STYLE"&&((m=h.rules)==null?void 0:m.length)>0&&(h.rules=[]),Ne(d,this.mirror)){const E=this.mirror.getId(d),D=this.newDocumentQueue.find(R=>R.parentId===E);D&&(this.attachDocumentToIframe(D,d),this.newDocumentQueue=this.newDocumentQueue.filter(R=>R!==D))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(o,h,d,c)};t.adds.forEach(c=>{s(c)});const l=Date.now();for(;a.length;){const c=pn(a);if(a.length=0,Date.now()-l>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(const u of c)r.getNode(u.value.parentId)?ot(u,m=>{s(m)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(o).length&&Object.assign(this.legacy_missingNodeRetryMap,o),mn(t.texts).forEach(c=>{var u;const m=r.getNode(c.id);if(!m)return t.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);if(m.textContent=c.value,this.usingVirtualDom){const h=m.parentNode;((u=h?.rules)==null?void 0:u.length)>0&&(h.rules=[])}}),t.attributes.forEach(c=>{const u=r.getNode(c.id);if(!u)return t.removes.find(m=>m.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);for(const m in c.attributes)if(typeof m=="string"){const h=c.attributes[m];if(h===null)u.removeAttribute(m);else if(typeof h=="string")try{if(m==="_cssText"&&(u.nodeName==="LINK"||u.nodeName==="STYLE"))try{const f=r.getMeta(u);Object.assign(f.attributes,c.attributes);const T=X(f,{doc:u.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),y=u.nextSibling,N=u.parentNode;if(T&&N){N.removeChild(u),N.insertBefore(T,y),r.replace(c.id,T);break}}catch{}u.setAttribute(m,h)}catch(f){this.warn("An error occurred may due to the checkout feature.",f)}else if(m==="style"){const f=h,T=u;for(const y in f)if(f[y]===!1)T.style.removeProperty(y);else if(f[y]instanceof Array){const N=f[y];T.style.setProperty(y,N[0],N[1])}else{const N=f[y];T.style.setProperty(y,N)}}}})}applyScroll(t,n){var r,o;const a=this.mirror.getNode(t.id);if(!a)return this.debugNodeNotFound(t,t.id);const i=this.mirror.getMeta(a);if(a===this.iframe.contentDocument)(r=this.iframe.contentWindow)==null||r.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else if(i?.type===C.Document)(o=a.defaultView)==null||o.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else try{a.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(t){const n=this.mirror.getNode(t.id);if(!n)return this.debugNodeNotFound(t,t.id);try{n.checked=t.isChecked,n.value=t.text}catch{}}applySelection(t){try{const n=new Set,r=t.ranges.map(({start:o,startOffset:a,end:i,endOffset:s})=>{const l=this.mirror.getNode(o),c=this.mirror.getNode(i);if(!l||!c)return;const u=new Range;u.setStart(l,a),u.setEnd(c,s);const m=l.ownerDocument,h=m?.getSelection();return h&&n.add(h),{range:u,selection:h}});n.forEach(o=>o.removeAllRanges()),r.forEach(o=>{var a;return o&&((a=o.selection)==null?void 0:a.addRange(o.range))})}catch{}}applyStyleSheetMutation(t){var n;let r=null;t.styleId?r=this.styleMirror.getStyle(t.styleId):t.id&&(r=((n=this.mirror.getNode(t.id))==null?void 0:n.sheet)||null),r&&(t.source===w.StyleSheetRule?this.applyStyleSheetRule(t,r):t.source===w.StyleDeclaration&&this.applyStyleDeclaration(t,r))}applyStyleSheetRule(t,n){var r,o,a,i;if((r=t.adds)==null||r.forEach(({rule:s,index:l})=>{try{if(Array.isArray(l)){const{positions:c,index:u}=at(l);q(n.cssRules,c).insertRule(s,u)}else{const c=l===void 0?void 0:Math.min(l,n.cssRules.length);n?.insertRule(s,c)}}catch{}}),(o=t.removes)==null||o.forEach(({index:s})=>{try{if(Array.isArray(s)){const{positions:l,index:c}=at(s);q(n.cssRules,l).deleteRule(c||0)}else n?.deleteRule(s)}catch{}}),t.replace)try{(a=n.replace)==null||a.call(n,t.replace)}catch{}if(t.replaceSync)try{(i=n.replaceSync)==null||i.call(n,t.replaceSync)}catch{}}applyStyleDeclaration(t,n){t.set&&q(n.rules,t.index).style.setProperty(t.set.property,t.set.value,t.set.priority),t.remove&&q(n.rules,t.index).style.removeProperty(t.remove.property)}applyAdoptedStyleSheet(t){var n;const r=this.mirror.getNode(t.id);if(!r)return;(n=t.styles)==null||n.forEach(s=>{var l;let c=null,u=null;if(oe(r)?u=((l=r.ownerDocument)==null?void 0:l.defaultView)||null:r.nodeName==="#document"&&(u=r.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,s.styleId),this.applyStyleSheetRule({source:w.StyleSheetRule,adds:s.rules},c)}catch{}});const o=10;let a=0;const i=(s,l)=>{const c=l.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);oe(s)?s.shadowRoot.adoptedStyleSheets=c:s.nodeName==="#document"&&(s.adoptedStyleSheets=c),c.length!==l.length&&a<o&&(setTimeout(()=>i(s,l),0+100*a),a++)};i(r,t.styleIds)}legacy_resolveMissingNode(t,n,r,o){const{previousId:a,nextId:i}=o,s=a&&t[a],l=i&&t[i];if(s){const{node:c,mutation:u}=s;n.insertBefore(c,r),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}if(l){const{node:c,mutation:u}=l;n.insertBefore(c,r.nextSibling),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}}moveAndHover(t,n,r,o,a){const i=this.mirror.getNode(r);if(!i)return this.debugNodeNotFound(a,r);const s=st(i,this.iframe),l=t*s.absoluteScale+s.x,c=n*s.absoluteScale+s.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${c}px`,o||this.drawMouseTail({x:l,y:c}),this.hoverElements(i)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:n,lineWidth:r,strokeStyle:o,duration:a}=this.config.mouseTail===!0?Se:Object.assign({},Se,this.config.mouseTail),i=()=>{if(!this.mouseTail)return;const s=this.mouseTail.getContext("2d");!s||!this.tailPositions.length||(s.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),s.beginPath(),s.lineWidth=r,s.lineCap=n,s.strokeStyle=o,s.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>s.lineTo(l.x,l.y)),s.stroke())};this.tailPositions.push(t),i(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(s=>s!==t),i()},a/this.speedService.state.context.timer.speed)}hoverElements(t){var n;(n=this.lastHoveredRootNode||this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(o=>{o.classList.remove(":hover")}),this.lastHoveredRootNode=t.getRootNode();let r=t;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(t){return t.type!==x.IncrementalSnapshot?!1:t.data.source>w.Mutation&&t.data.source<=w.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(M.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,n){this.warn(`Node with id '${n}' not found. `,t)}warnCanvasMutationFailed(t,n){this.warn("Has error on canvas update",n,"canvas mutation:",t)}debugNodeNotFound(t,n){this.debug(`Node with id '${n}' not found. `,t)}warn(...t){!this.config.showWarning||this.config.logger.warn(mt,...t)}debug(...t){!this.config.showDebug||this.config.logger.log(mt,...t)}}return ue.Replayer=Ln,Object.defineProperty(ue,"__esModule",{value:!0}),ue}({});
//# sourceMappingURL=rrweb-replay.min.js.map
